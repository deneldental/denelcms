(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,796506,e=>{"use strict";var t=e.i(843476),s=e.i(271645),a=e.i(167881),n=e.i(62870),r=e.i(373375),l=e.i(463059),i=e.i(401851),d=e.i(677241),o=e.i(281092);function c(e,t,s){let a=(0,o.toDate)(e,s?.in);if(isNaN(t))return(0,d.constructFrom)(s?.in||e,NaN);if(!t)return a;let n=a.getDate(),r=(0,d.constructFrom)(s?.in||e,a.getTime());return(r.setMonth(a.getMonth()+t+1,0),n>=r.getDate())?r:(a.setFullYear(r.getFullYear(),r.getMonth(),n),a)}function m(e,t,s){let a=(0,o.toDate)(e,s?.in);return isNaN(t)?(0,d.constructFrom)(s?.in||e,NaN):(t&&a.setDate(a.getDate()+t),a)}function u({date:e,setDate:s,view:d,setView:o}){return(0,t.jsxs)("div",{className:"flex items-center justify-between py-4",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsxs)("div",{className:"flex items-center rounded-md border bg-background shadow-sm",children:[(0,t.jsx)(a.Button,{variant:"ghost",size:"icon",onClick:()=>{switch(d){case"year":s(c(e,-12,void 0));break;case"month":s(c(e,-1,void 0));break;case"week":s(m(e,-7,void 0));break;case"day":s(m(e,-1,void 0))}},className:"h-8 w-8 rounded-none rounded-l-md",children:(0,t.jsx)(r.ChevronLeft,{className:"h-4 w-4"})}),(0,t.jsx)(a.Button,{variant:"ghost",size:"sm",onClick:()=>s(new Date),className:"h-8 rounded-none font-normal",children:"Today"}),(0,t.jsx)(a.Button,{variant:"ghost",size:"icon",onClick:()=>{switch(d){case"year":s(c(e,12,void 0));break;case"month":s(c(e,1));break;case"week":s(m(e,7,void 0));break;case"day":s(m(e,1))}},className:"h-8 w-8 rounded-none rounded-r-md",children:(0,t.jsx)(l.ChevronRight,{className:"h-4 w-4"})})]}),(0,t.jsx)("h2",{className:"text-xl font-semibold ml-4",children:(0,i.format)(e,"year"===d?"yyyy":"MMMM yyyy")})]}),(0,t.jsx)("div",{className:"flex items-center gap-2",children:(0,t.jsxs)(n.Select,{value:d,onValueChange:e=>o(e),children:[(0,t.jsx)(n.SelectTrigger,{className:"w-[120px]",children:(0,t.jsx)(n.SelectValue,{placeholder:"View"})}),(0,t.jsxs)(n.SelectContent,{children:[(0,t.jsx)(n.SelectItem,{value:"year",children:"Year"}),(0,t.jsx)(n.SelectItem,{value:"month",children:"Month"}),(0,t.jsx)(n.SelectItem,{value:"week",children:"Week"}),(0,t.jsx)(n.SelectItem,{value:"day",children:"Day"})]})]})})]})}function x(){return(0,t.jsx)("div",{className:"flex items-center justify-center h-[500px] border rounded-lg bg-muted/10",children:(0,t.jsx)("span",{className:"text-muted-foreground",children:"Year View Under Construction"})})}var h=e.i(39978),p=e.i(614522),f=e.i(455024);function g(e,t){let s=(0,f.getDefaultOptions)(),a=t?.weekStartsOn??t?.locale?.options?.weekStartsOn??s.weekStartsOn??s.locale?.options?.weekStartsOn??0,n=(0,o.toDate)(e,t?.in),r=n.getDay();return n.setDate(n.getDate()+((r<a?-7:0)+6-(r-a))),n.setHours(23,59,59,999),n}var j=e.i(845110);function v(e,t){let{start:s,end:a}=function(e,t){let[s,a]=(0,j.normalizeDates)(e,t.start,t.end);return{start:s,end:a}}(t?.in,e),n=+s>+a,r=n?+s:+a,l=n?a:s;l.setHours(0,0,0,0);let i=t?.step??1;if(!i)return[];i<0&&(i=-i,n=!n);let o=[];for(;+l<=r;)o.push((0,d.constructFrom)(s,l)),l.setDate(l.getDate()+i),l.setHours(0,0,0,0);return n?o.reverse():o}var y=e.i(585890);function N(e,t,s){let[a,n]=(0,j.normalizeDates)(s?.in,e,t);return+(0,y.startOfDay)(a)==+(0,y.startOfDay)(n)}var b=e.i(24708);function w(e,t){return N((0,d.constructFrom)(t?.in||e,e),(0,b.constructNow)(t?.in||e))}var S=e.i(647163);function C({date:e,events:s,onEventClick:a,onDateClick:n}){let r,l=((r=(0,o.toDate)(e,void 0)).setDate(1),r.setHours(0,0,0,0),r),d=(0,h.endOfMonth)(e),c=v({start:(0,p.startOfWeek)(l),end:g(d)});return(0,t.jsxs)("div",{className:"flex flex-col h-full border rounded-lg overflow-hidden bg-background",children:[(0,t.jsx)("div",{className:"grid grid-cols-7 border-b",children:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"].map(e=>(0,t.jsx)("div",{className:"py-2 text-center text-sm font-semibold text-muted-foreground border-r last:border-r-0",children:e},e))}),(0,t.jsx)("div",{className:"grid grid-cols-7 grid-rows-5 flex-1 min-h-[600px]",children:c.map(e=>{let r=s.filter(t=>N(t.date,e));return(0,t.jsxs)("div",{className:(0,S.cn)("min-h-[120px] p-2 border-b border-r last:border-r-0 relative group transition-colors hover:bg-muted/30 cursor-pointer",!function(e,t,s){let[a,n]=(0,j.normalizeDates)(void 0,e,t);return a.getFullYear()===n.getFullYear()&&a.getMonth()===n.getMonth()}(e,l)&&"bg-muted/10 text-muted-foreground",w(e)&&"bg-blue-50/50"),onClick:()=>n?.(e),children:[(0,t.jsx)("div",{className:"flex justify-between items-start",children:(0,t.jsx)("span",{className:(0,S.cn)("text-sm font-medium w-7 h-7 flex items-center justify-center rounded-full",w(e)&&"bg-primary text-primary-foreground"),children:(0,i.format)(e,"d")})}),(0,t.jsx)("div",{className:"mt-2 space-y-1",children:r.map(e=>(0,t.jsxs)("div",{onClick:t=>{t.stopPropagation(),a?.(e)},className:(0,S.cn)("text-xs px-2 py-1 rounded truncate cursor-pointer","appointment"===e.type?"bg-blue-100 text-blue-700 hover:bg-blue-200":"bg-red-100 text-red-700 hover:bg-red-200"),children:[(0,i.format)(e.date,"HH:mm")," ",e.title]},`${e.type}-${e.id}`))})]},e.toString())})})]})}function D({date:e,events:s,onEventClick:a,onDateClick:n}){let r=v({start:(0,p.startOfWeek)(e),end:g(e)}),l=Array.from({length:13},(e,t)=>t+8);return(0,t.jsxs)("div",{className:"flex flex-col h-full border rounded-lg overflow-hidden bg-background",children:[(0,t.jsxs)("div",{className:"grid grid-cols-8 border-b",children:[(0,t.jsx)("div",{className:"w-16 border-r p-2"})," ",r.map(e=>(0,t.jsxs)("div",{className:(0,S.cn)("p-2 text-center border-r last:border-r-0",w(e)&&"bg-blue-50"),children:[(0,t.jsx)("div",{className:"text-xs text-muted-foreground",children:(0,i.format)(e,"EEE")}),(0,t.jsx)("div",{className:(0,S.cn)("text-lg font-semibold w-8 h-8 rounded-full flex items-center justify-center mx-auto",w(e)&&"bg-primary text-primary-foreground"),children:(0,i.format)(e,"d")})]},e.toString()))]}),(0,t.jsx)("div",{className:"overflow-y-auto max-h-[600px]",children:(0,t.jsxs)("div",{className:"grid grid-cols-8 relative",children:[(0,t.jsx)("div",{className:"w-16 border-r text-xs text-muted-foreground text-center",children:l.map(e=>(0,t.jsx)("div",{className:"h-20 border-b relative",children:(0,t.jsxs)("span",{className:"absolute -top-3 left-0 right-0",children:[e,":00"]})},e))}),r.map(e=>(0,t.jsxs)("div",{className:"border-r last:border-r-0 relative",children:[l.map(s=>(0,t.jsx)("div",{className:"h-20 border-b hover:bg-muted/20 cursor-pointer",onClick:()=>{let t=(0,y.startOfDay)(e);t.setHours(s),n?.(t)}},s)),s.filter(t=>N(t.date,e)).map(e=>{let s=e.date.getHours();return s<8||s>20?null:(0,t.jsxs)("div",{className:(0,S.cn)("absolute left-1 right-1 p-1 rounded text-xs border overflow-hidden cursor-pointer shadow-sm","appointment"===e.type?"bg-blue-100 border-blue-200 text-blue-700":"bg-red-100 border-red-200 text-red-700"),style:{top:`${(s-8)*80}px`,height:"70px"},onClick:t=>{t.stopPropagation(),a?.(e)},children:[(0,t.jsx)("div",{className:"font-semibold",children:(0,i.format)(e.date,"HH:mm")}),(0,t.jsx)("div",{className:"truncate",children:e.title})]},`${e.type}-${e.id}`)})]},e.toString()))]})})]})}function k({date:e,events:s,onEventClick:a,onDateClick:n}){let r=Array.from({length:17},(e,t)=>t+6);return(0,t.jsxs)("div",{className:"flex flex-col h-full border rounded-lg overflow-hidden bg-background",children:[(0,t.jsxs)("div",{className:"p-4 border-b text-center bg-muted/20",children:[(0,t.jsx)("div",{className:"text-sm text-muted-foreground",children:(0,i.format)(e,"EEEE")}),(0,t.jsx)("div",{className:(0,S.cn)("text-3xl font-bold inline-block rounded-full px-4",w(e)&&"text-primary"),children:(0,i.format)(e,"d")})]}),(0,t.jsx)("div",{className:"overflow-y-auto flex-1 min-h-[600px]",children:(0,t.jsxs)("div",{className:"relative",children:[r.map(s=>(0,t.jsxs)("div",{className:"flex h-24 border-b relative group",children:[(0,t.jsxs)("div",{className:"w-20 border-r flex-shrink-0 text-right pr-4 pt-2 text-sm text-muted-foreground bg-muted/5 font-medium",children:[s,":00"]}),(0,t.jsx)("div",{className:"flex-1 relative hover:bg-muted/10 cursor-pointer",onClick:()=>{let t=(0,y.startOfDay)(e);t.setHours(s),n?.(t)}})]},s)),s.filter(t=>N(t.date,e)).map(e=>{let s=e.date.getHours(),n=e.date.getMinutes();return s<6||s>22?null:(0,t.jsxs)("div",{className:(0,S.cn)("absolute left-24 right-4 p-3 rounded-md text-sm border shadow-sm cursor-pointer hover:shadow-md transition-shadow","appointment"===e.type?"bg-blue-100 border-blue-200 text-blue-800":"bg-red-100 border-red-200 text-red-800"),style:{top:`${(s-6)*96+n/60*96}px`,height:"88px"},onClick:t=>{t.stopPropagation(),a?.(e)},children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 font-semibold",children:[(0,t.jsx)("div",{className:(0,S.cn)("w-2 h-2 rounded-full","appointment"===e.type?"bg-blue-500":"bg-red-500")}),(0,i.format)(e.date,"h:mm a")," - ",e.title]}),(0,t.jsx)("div",{className:"text-xs opacity-75 mt-1",children:"appointment"===e.type?"Check details":"Blocked"})]},`${e.type}-${e.id}`)})]})})]})}var T=e.i(618566);function I({appointments:e,unavailability:a,onDateClick:n,onAppointmentClick:r,onUnavailabilityClick:l}){let i=(0,T.useRouter)(),d=(0,T.useSearchParams)(),[o,c]=(0,s.useState)(d.get("date")?new Date(d.get("date")):new Date),[m,h]=(0,s.useState)(d.get("view")||"month");(0,s.useEffect)(()=>{},[o,m,i,d]);let p=[...e.filter(e=>{let t="string"==typeof e.status?e.status:void 0;return"cancelled"!==t&&"completed"!==t}).map(e=>({id:e.id,title:"object"==typeof e.patient&&e.patient&&"name"in e.patient&&e.patient.name||"Unknown Patient",date:new Date(e.date),type:"appointment",appointment:e})),...a.map(e=>({id:e.id,title:"Unavailable",date:new Date(e.startTime),type:"unavailability",unavailability:e}))],f=e=>{"appointment"===e.type&&e.appointment&&r?r(e.appointment):"unavailability"===e.type&&e.unavailability&&l&&l(e.unavailability)};return(0,t.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,t.jsx)(u,{date:o,setDate:e=>{c(e)},view:m,setView:h}),(0,t.jsxs)("div",{className:"min-h-[600px]",children:["year"===m&&(0,t.jsx)(x,{}),"month"===m&&(0,t.jsx)(C,{date:o,events:p,onDateClick:n,onEventClick:f}),"week"===m&&(0,t.jsx)(D,{date:o,events:p,onDateClick:n,onEventClick:f}),"day"===m&&(0,t.jsx)(k,{date:o,events:p,onDateClick:n,onEventClick:f})]})]})}var P=e.i(127341),F=e.i(98865),E=e.i(561654),O=e.i(994179),R=e.i(541071),A=e.i(286536),M=e.i(788699),L=e.i(727612),B=e.i(463415);let V=[{accessorKey:"date",header:({column:e})=>(0,t.jsx)(E.DataTableColumnHeader,{column:e,title:"Date"}),cell:({row:e})=>{let s=new Date(e.getValue("date"));return(0,t.jsx)("div",{children:(0,i.format)(s,"MMM d, yyyy")})}},{id:"time",accessorKey:"date",header:({column:e})=>(0,t.jsx)(E.DataTableColumnHeader,{column:e,title:"Time"}),cell:({row:e})=>{let s=new Date(e.getValue("date"));return(0,t.jsx)("div",{children:(0,i.format)(s,"h:mm a")})}},{accessorKey:"patient.name",header:({column:e})=>(0,t.jsx)(E.DataTableColumnHeader,{column:e,title:"Patient"}),cell:({row:e})=>(0,t.jsx)("div",{className:"font-medium",children:e.original.patient?.name||"Unknown"})},{accessorKey:"doctor.user.name",header:({column:e})=>(0,t.jsx)(E.DataTableColumnHeader,{column:e,title:"Doctor"}),cell:({row:e})=>(0,t.jsx)("div",{children:e.original.doctor?.user?.name||"Unknown"})},{accessorKey:"type",header:({column:e})=>(0,t.jsx)(E.DataTableColumnHeader,{column:e,title:"Type"}),cell:({row:e})=>(0,t.jsx)("div",{className:"capitalize",children:e.getValue("type")})},{accessorKey:"status",header:({column:e})=>(0,t.jsx)(E.DataTableColumnHeader,{column:e,title:"Status"}),cell:({row:e})=>{let s=e.getValue("status");return(0,t.jsx)(O.Badge,{variant:"scheduled"===s?"default":"completed"===s?"secondary":"cancelled"===s?"destructive":"outline",children:s})}},{id:"actions",cell:({row:e})=>{let s=e.original;return(0,t.jsxs)(B.DropdownMenu,{children:[(0,t.jsx)(B.DropdownMenuTrigger,{asChild:!0,children:(0,t.jsxs)(a.Button,{variant:"ghost",className:"h-8 w-8 p-0",children:[(0,t.jsx)("span",{className:"sr-only",children:"Open menu"}),(0,t.jsx)(R.MoreHorizontal,{className:"h-4 w-4"})]})}),(0,t.jsxs)(B.DropdownMenuContent,{align:"end",children:[(0,t.jsxs)(B.DropdownMenuItem,{onClick:()=>s.onRowClick?.(),children:[(0,t.jsx)(A.Eye,{className:"mr-2 h-4 w-4"}),"View Details"]}),(0,t.jsxs)(B.DropdownMenuItem,{children:[(0,t.jsx)(M.Pencil,{className:"mr-2 h-4 w-4"}),"Edit"]}),(0,t.jsx)(B.DropdownMenuSeparator,{}),(0,t.jsxs)(B.DropdownMenuItem,{className:"text-destructive",children:[(0,t.jsx)(L.Trash2,{className:"mr-2 h-4 w-4"}),"Delete"]})]})]})}}];var $=e.i(630374),H=e.i(23750),U=e.i(10708),z=e.i(625959),q=e.i(87316),_=e.i(503116),G=e.i(761911),K=e.i(178583),W=e.i(120286),Y=e.i(284614),X=e.i(531278),Z=e.i(491423),Z=Z,J=e.i(37727),Q=e.i(595468),ee=e.i(245423),et=e.i(95187);let es=(0,et.createServerReference)("70b8b3e4270a2a7de6cffa591e444b784795561734",et.callServer,void 0,et.findSourceMapURL,"updateAppointment");var ea=e.i(23467),en=e.i(720652);let er=(0,et.createServerReference)("00db6e304536ce2d1913941ac09bd8bb9e6fbc6ab5",et.callServer,void 0,et.findSourceMapURL,"getAppointmentTypes");var el=e.i(846696),ei=e.i(981140),ed=e.i(820783);function eo(e,a=[]){let n=[],r=()=>{let t=n.map(e=>s.createContext(e));return function(a){let n=a?.[e]||t;return s.useMemo(()=>({[`__scope${e}`]:{...a,[e]:n}}),[a,n])}};return r.scopeName=e,[function(a,r){let l=s.createContext(r),i=n.length;n=[...n,r];let d=a=>{let{scope:n,children:r,...d}=a,o=n?.[e]?.[i]||l,c=s.useMemo(()=>d,Object.values(d));return(0,t.jsx)(o.Provider,{value:c,children:r})};return d.displayName=a+"Provider",[d,function(t,n){let d=n?.[e]?.[i]||l,o=s.useContext(d);if(o)return o;if(void 0!==r)return r;throw Error(`\`${t}\` must be used within \`${a}\``)}]},function(...e){let t=e[0];if(1===e.length)return t;let a=()=>{let a=e.map(e=>({useScope:e(),scopeName:e.scopeName}));return function(e){let n=a.reduce((t,{useScope:s,scopeName:a})=>{let n=s(e)[`__scope${a}`];return{...t,...n}},{});return s.useMemo(()=>({[`__scope${t.scopeName}`]:n}),[n])}};return a.scopeName=t.scopeName,a}(r,...a)]}e.i(174080);var ec=Symbol("radix.slottable");function em(e){return s.isValidElement(e)&&"function"==typeof e.type&&"__radixId"in e.type&&e.type.__radixId===ec}var eu=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"].reduce((e,a)=>{var n,r;let l,i,d,o=(r=n=`Primitive.${a}`,(l=s.forwardRef((e,t)=>{let{children:a,...n}=e;if(s.isValidElement(a)){var r;let e,l,i=(r=a,(l=(e=Object.getOwnPropertyDescriptor(r.props,"ref")?.get)&&"isReactWarning"in e&&e.isReactWarning)?r.ref:(l=(e=Object.getOwnPropertyDescriptor(r,"ref")?.get)&&"isReactWarning"in e&&e.isReactWarning)?r.props.ref:r.props.ref||r.ref),d=function(e,t){let s={...t};for(let a in t){let n=e[a],r=t[a];/^on[A-Z]/.test(a)?n&&r?s[a]=(...e)=>{let t=r(...e);return n(...e),t}:n&&(s[a]=n):"style"===a?s[a]={...n,...r}:"className"===a&&(s[a]=[n,r].filter(Boolean).join(" "))}return{...e,...s}}(n,a.props);return a.type!==s.Fragment&&(d.ref=t?(0,ed.composeRefs)(t,i):i),s.cloneElement(a,d)}return s.Children.count(a)>1?s.Children.only(null):null})).displayName=`${r}.SlotClone`,i=l,(d=s.forwardRef((e,a)=>{let{children:n,...r}=e,l=s.Children.toArray(n),d=l.find(em);if(d){let e=d.props.children,n=l.map(t=>t!==d?t:s.Children.count(e)>1?s.Children.only(null):s.isValidElement(e)?e.props.children:null);return(0,t.jsx)(i,{...r,ref:a,children:s.isValidElement(e)?s.cloneElement(e,void 0,n):null})}return(0,t.jsx)(i,{...r,ref:a,children:n})})).displayName=`${n}.Slot`,d),c=s.forwardRef((e,s)=>{let{asChild:n,...r}=e;return"undefined"!=typeof window&&(window[Symbol.for("radix-ui")]=!0),(0,t.jsx)(n?o:a,{...r,ref:s})});return c.displayName=`Primitive.${a}`,{...e,[a]:c}},{}),ex=e.i(842727),eh=e.i(369340),ep=e.i(586318),ef=e.i(635804),eg=e.i(999682),ej=e.i(296626),ev="Radio",[ey,eN]=eo(ev),[eb,ew]=ey(ev),eS=s.forwardRef((e,a)=>{let{__scopeRadio:n,name:r,checked:l=!1,required:i,disabled:d,value:o="on",onCheck:c,form:m,...u}=e,[x,h]=s.useState(null),p=(0,ed.useComposedRefs)(a,e=>h(e)),f=s.useRef(!1),g=!x||m||!!x.closest("form");return(0,t.jsxs)(eb,{scope:n,checked:l,disabled:d,children:[(0,t.jsx)(eu.button,{type:"button",role:"radio","aria-checked":l,"data-state":eT(l),"data-disabled":d?"":void 0,disabled:d,value:o,...u,ref:p,onClick:(0,ei.composeEventHandlers)(e.onClick,e=>{l||c?.(),g&&(f.current=e.isPropagationStopped(),f.current||e.stopPropagation())})}),g&&(0,t.jsx)(ek,{control:x,bubbles:!f.current,name:r,value:o,checked:l,required:i,disabled:d,form:m,style:{transform:"translateX(-100%)"}})]})});eS.displayName=ev;var eC="RadioIndicator",eD=s.forwardRef((e,s)=>{let{__scopeRadio:a,forceMount:n,...r}=e,l=ew(eC,a);return(0,t.jsx)(ej.Presence,{present:n||l.checked,children:(0,t.jsx)(eu.span,{"data-state":eT(l.checked),"data-disabled":l.disabled?"":void 0,...r,ref:s})})});eD.displayName=eC;var ek=s.forwardRef(({__scopeRadio:e,control:a,checked:n,bubbles:r=!0,...l},i)=>{let d=s.useRef(null),o=(0,ed.useComposedRefs)(d,i),c=(0,eg.usePrevious)(n),m=(0,ef.useSize)(a);return s.useEffect(()=>{let e=d.current;if(!e)return;let t=Object.getOwnPropertyDescriptor(window.HTMLInputElement.prototype,"checked").set;if(c!==n&&t){let s=new Event("click",{bubbles:r});t.call(e,n),e.dispatchEvent(s)}},[c,n,r]),(0,t.jsx)(eu.input,{type:"radio","aria-hidden":!0,defaultChecked:n,...l,tabIndex:-1,ref:o,style:{...l.style,...m,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})});function eT(e){return e?"checked":"unchecked"}ek.displayName="RadioBubbleInput";var eI=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"],eP="RadioGroup",[eF,eE]=eo(eP,[ex.createRovingFocusGroupScope,eN]),eO=(0,ex.createRovingFocusGroupScope)(),eR=eN(),[eA,eM]=eF(eP),eL=s.forwardRef((e,s)=>{let{__scopeRadioGroup:a,name:n,defaultValue:r,value:l,required:i=!1,disabled:d=!1,orientation:o,dir:c,loop:m=!0,onValueChange:u,...x}=e,h=eO(a),p=(0,ep.useDirection)(c),[f,g]=(0,eh.useControllableState)({prop:l,defaultProp:r??null,onChange:u,caller:eP});return(0,t.jsx)(eA,{scope:a,name:n,required:i,disabled:d,value:f,onValueChange:g,children:(0,t.jsx)(ex.Root,{asChild:!0,...h,orientation:o,dir:p,loop:m,children:(0,t.jsx)(eu.div,{role:"radiogroup","aria-required":i,"aria-orientation":o,"data-disabled":d?"":void 0,dir:p,...x,ref:s})})})});eL.displayName=eP;var eB="RadioGroupItem",eV=s.forwardRef((e,a)=>{let{__scopeRadioGroup:n,disabled:r,...l}=e,i=eM(eB,n),d=i.disabled||r,o=eO(n),c=eR(n),m=s.useRef(null),u=(0,ed.useComposedRefs)(a,m),x=i.value===l.value,h=s.useRef(!1);return s.useEffect(()=>{let e=e=>{eI.includes(e.key)&&(h.current=!0)},t=()=>h.current=!1;return document.addEventListener("keydown",e),document.addEventListener("keyup",t),()=>{document.removeEventListener("keydown",e),document.removeEventListener("keyup",t)}},[]),(0,t.jsx)(ex.Item,{asChild:!0,...o,focusable:!d,active:x,children:(0,t.jsx)(eS,{disabled:d,required:i.required,checked:x,...c,...l,name:i.name,ref:u,onCheck:()=>i.onValueChange(l.value),onKeyDown:(0,ei.composeEventHandlers)(e=>{"Enter"===e.key&&e.preventDefault()}),onFocus:(0,ei.composeEventHandlers)(l.onFocus,()=>{h.current&&m.current?.click()})})})});eV.displayName=eB;var e$=s.forwardRef((e,s)=>{let{__scopeRadioGroup:a,...n}=e,r=eR(a);return(0,t.jsx)(eD,{...r,...n,ref:s})});e$.displayName="RadioGroupIndicator";var eH=e.i(114683);let eU=s.forwardRef(({className:e,...s},a)=>(0,t.jsx)(eL,{className:(0,S.cn)("grid gap-2",e),...s,ref:a}));eU.displayName=eL.displayName;let ez=s.forwardRef(({className:e,...s},a)=>(0,t.jsx)(eV,{ref:a,className:(0,S.cn)("aspect-square h-4 w-4 rounded-full border border-primary text-primary ring-offset-background focus:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",e),...s,children:(0,t.jsx)(e$,{className:"flex items-center justify-center",children:(0,t.jsx)(eH.Circle,{className:"h-2.5 w-2.5 fill-current text-current"})})}));ez.displayName=eV.displayName;var eq=e.i(561659),e_=e.i(871689),eG=e.i(899988),eK=e.i(993766),eW=e.i(131343),eY=e.i(762332),eX=e.i(416355),eZ=e.i(335883),eJ=e.i(685946);function eQ({open:r,onOpenChange:l,appointment:i,onSuccess:d}){let o=(0,T.useRouter)(),[c,m]=(0,s.useState)(!1),[u,x]=(0,s.useState)(null),[h,p]=(0,s.useState)([]),[f,g]=(0,s.useState)([]),[j,v]=(0,s.useState)([]),[y,N]=(0,s.useState)(null),[b,w]=(0,s.useState)(0),[S,C]=(0,s.useState)({amount:"",method:"",description:"",sendNotification:!0}),D=(0,s.useCallback)(async()=>{if(!i?.patientId)return;let[e,t]=await Promise.all([(0,eY.getPaymentPlanByPatientId)(i.patientId),(0,eX.getPaymentsByPatientId)(i.patientId)]);if(e.success&&e.data){let s=e.data;N(s);let a=t.success&&t.data?t.data.filter(e=>"completed"===e.status&&e.paymentPlanId===s.id).reduce((e,t)=>e+(t.amount||0),0):0;w((s.totalAmount||0)-a)}},[i?.patientId]);(0,s.useEffect)(()=>{r&&i&&(k(),I(),i.patient?.isOrtho&&D())},[r,i,D]),(0,s.useEffect)(()=>{r||(x(null),C({amount:"",method:"",description:"",sendNotification:!0}),v([]))},[r]);let k=async()=>{let e=await (0,eK.getPaymentMethods)();if(e.success&&e.data){p(e.data);let t=e.data.find(e=>"cash"===e.name);C(s=>({...s,method:t?"cash":e.data[0]?.name||""}))}},I=async()=>{let e=await (0,eW.getTreatmentTypes)();e.success&&e.data&&g(e.data)},P=async t=>{if(t.preventDefault(),!i)return void el.toast.error("Appointment not found");if(!u)return void el.toast.error("Please select a payment type");if(!S.method)return void el.toast.error("Please select a payment method");if(!S.amount||0>=parseFloat(S.amount))return void el.toast.error("Please enter a valid amount");if("one-time"===u&&0===j.length)return void el.toast.error("Please select at least one treatment type");m(!0);try{let t=Math.round(100*parseFloat(S.amount)),s=S.description||`Payment for ${i.type||"appointment"} appointment`;if("one-time"===u&&j.length>0)if(f&&f.length>0){let e=f.filter(e=>j.includes(e.id)).map(e=>e.displayName||e.name);e.length>0&&(s=e.join(", "),S.description&&S.description.trim()&&(s=`${s} - ${S.description.trim()}`))}else s=S.description||`One-time payment for ${i.type||"appointment"} appointment`;let a={patientId:i.patientId,amount:t,method:S.method,description:s,status:"completed",sendNotification:S.sendNotification};"plan"===u&&y&&(a.paymentPlanId=y.id);let n=await (0,eG.createPayment)(a);if(!n.success){el.toast.error(n.error||"Failed to process payment"),m(!1);return}let r=i.notes?`${i.notes}

[Checked in at ${new Date().toLocaleString()}]`:`[Checked in at ${new Date().toLocaleString()}]`;if(!(await es(i.id,{status:"completed",notes:r})).success){el.toast.error("Payment processed but failed to update appointment status"),m(!1);return}let{createPendingMedicalRecord:c}=await e.A(897188);try{await c({patientId:i.patientId,doctorId:i.doctorId,appointmentId:i.id})}catch(e){console.error("Failed to create pending medical record:",e)}if(n.data&&i.patient?.name)try{let e="plan"===u&&y?"number"==typeof y.totalAmountCents?y.totalAmountCents:"number"==typeof y.totalAmount?y.totalAmount:void 0:void 0;(0,eJ.generatePaymentReceipt)({patientName:i.patient.name,amountPaid:t,paymentMethod:S.method,description:s,appointmentDate:new Date,paymentType:u,paymentPlanTotal:e,paymentPlanBalance:"plan"===u&&b>0?b-t:void 0,autoPrint:!0})}catch(e){console.error("Failed to generate receipt:",e)}el.toast.success("Patient checked in and payment processed successfully!"),o.refresh(),d?.(),l(!1)}catch(e){console.error("Error processing check-in payment:",e),el.toast.error("An error occurred while processing the payment")}finally{m(!1)}};return i?(0,t.jsx)($.Dialog,{open:r,onOpenChange:l,children:(0,t.jsxs)($.DialogContent,{className:"max-w-md",children:[(0,t.jsxs)($.DialogHeader,{children:[(0,t.jsx)($.DialogTitle,{children:"Check In & Process Payment"}),(0,t.jsxs)($.DialogDescription,{children:["Check in ",i.patient?.name," and process their payment"]})]}),u?(0,t.jsxs)("form",{onSubmit:P,className:"space-y-4",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 mb-4",children:[(0,t.jsx)(a.Button,{type:"button",variant:"ghost",size:"icon",onClick:()=>x(null),disabled:c,children:(0,t.jsx)(e_.ArrowLeft,{className:"h-4 w-4"})}),(0,t.jsx)("div",{className:"text-sm font-medium",children:"one-time"===u?"One-Time Payment":"Payment Plan"})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(U.Label,{htmlFor:"amount",children:"Amount (GHS) *"}),(0,t.jsx)(H.Input,{id:"amount",type:"number",step:"0.01",min:"0",placeholder:"0.00",value:S.amount,onChange:e=>C({...S,amount:e.target.value}),required:!0}),"plan"===u&&b>0&&(0,t.jsxs)("p",{className:"text-sm text-muted-foreground",children:["Outstanding balance: GH₵ ",(b/100).toFixed(2)]})]}),"one-time"===u&&(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(U.Label,{children:"Treatment Types *"}),(0,t.jsx)(eZ.TreatmentTypesMultiSelect,{value:j,onChange:v,placeholder:"Select treatment types..."})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(U.Label,{htmlFor:"method",children:"Payment Method *"}),(0,t.jsxs)(n.Select,{value:S.method,onValueChange:e=>C({...S,method:e}),required:!0,children:[(0,t.jsx)(n.SelectTrigger,{id:"method",children:(0,t.jsx)(n.SelectValue,{placeholder:"Select method"})}),(0,t.jsx)(n.SelectContent,{children:h.map(e=>(0,t.jsx)(n.SelectItem,{value:e.name,children:e.displayName||e.name},e.id))})]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(U.Label,{htmlFor:"description",children:"Description (Optional)"}),(0,t.jsx)(H.Input,{id:"description",placeholder:"Add payment notes...",value:S.description,onChange:e=>C({...S,description:e.target.value})})]}),(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)(z.Checkbox,{id:"sendNotification",checked:S.sendNotification,onCheckedChange:e=>C({...S,sendNotification:e})}),(0,t.jsx)(U.Label,{htmlFor:"sendNotification",className:"text-sm font-normal cursor-pointer",children:"Send payment receipt via SMS"})]}),(0,t.jsxs)("div",{className:"flex justify-end gap-2 pt-4",children:[(0,t.jsx)(a.Button,{type:"button",variant:"outline",onClick:()=>l(!1),disabled:c,children:"Cancel"}),(0,t.jsxs)(a.Button,{type:"submit",disabled:c,children:[c&&(0,t.jsx)(X.Loader2,{className:"mr-2 h-4 w-4 animate-spin"}),"Check In & Pay"]})]})]}):(0,t.jsxs)("div",{className:"space-y-4 py-4",children:[(0,t.jsx)(U.Label,{children:"Select Payment Type"}),(0,t.jsxs)(eU,{value:u||"",onValueChange:e=>x(e),className:"space-y-3",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-3 border rounded-lg p-4 cursor-pointer hover:bg-accent",children:[(0,t.jsx)(ez,{value:"one-time",id:"one-time"}),(0,t.jsxs)(U.Label,{htmlFor:"one-time",className:"flex items-center gap-2 cursor-pointer flex-1",children:[(0,t.jsx)(eq.CreditCard,{className:"h-5 w-5"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"font-medium",children:"One-Time Payment"}),(0,t.jsx)("div",{className:"text-sm text-muted-foreground",children:"Pay for specific treatments"})]})]})]}),i.patient?.isOrtho&&(0,t.jsxs)("div",{className:"flex items-center space-x-3 border rounded-lg p-4 cursor-pointer hover:bg-accent",children:[(0,t.jsx)(ez,{value:"plan",id:"plan"}),(0,t.jsxs)(U.Label,{htmlFor:"plan",className:"flex items-center gap-2 cursor-pointer flex-1",children:[(0,t.jsx)(q.Calendar,{className:"h-5 w-5"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"font-medium",children:"Payment Plan"}),(0,t.jsx)("div",{className:"text-sm text-muted-foreground",children:y?`Outstanding: GH₵ ${(b/100).toFixed(2)}`:"Installment payment"})]})]})]})]}),(0,t.jsxs)("div",{className:"flex justify-end gap-2 pt-4",children:[(0,t.jsx)(a.Button,{variant:"outline",onClick:()=>l(!1),children:"Cancel"}),(0,t.jsx)(a.Button,{onClick:()=>{u||el.toast.error("Please select a payment type")},disabled:!u,children:"Continue"})]})]})]})}):null}function e0({open:e,onOpenChange:r,appointment:l,onUpdate:d,onDelete:o,readOnly:c=!1}){let m=(0,T.useRouter)(),[u,x]=(0,s.useState)(!1),[h,p]=(0,s.useState)(!1),[f,g]=(0,s.useState)([]),[j,v]=(0,s.useState)([]),[y,N]=(0,s.useState)([]),[b,w]=(0,s.useState)(!1),[S,C]=(0,s.useState)({date:"",time:"",type:"",status:"",notes:"",patientId:"",doctorId:""}),[D,k]=(0,s.useState)(!1);if((0,s.useEffect)(()=>{if(!l)return;let e=new Date(l.date);C({date:new Date(e.getTime()-6e4*e.getTimezoneOffset()).toISOString().slice(0,10),time:new Date(e.getTime()-6e4*e.getTimezoneOffset()).toISOString().slice(11,16),type:l.type||"",status:l.status||"scheduled",notes:l.notes||"",patientId:l.patientId||"",doctorId:l.doctorId||""})},[l]),(0,s.useEffect)(()=>{u&&e&&((0,ea.getPatients)().then(e=>{e.success?g(e.data||[]):el.toast.error(e.error||"Failed to load patients")}),(0,en.getDoctors)().then(e=>{e.success?v(e.data||[]):el.toast.error(e.error||"Failed to load doctors")}),er().then(e=>{e.success?N(e.data||[]):el.toast.error(e.error||"Failed to load appointment types")}))},[u,e]),(0,s.useEffect)(()=>{e||x(!1)},[e]),!l)return null;let I=new Date(l.date),P=new Date(I.getTime()+6e4*(l.durationMinutes||30)),F=async()=>{if(l){p(!0);try{let e=new Date(`${S.date}T${S.time}`),t=new Date(l.date),s=new Date(t.getTime()-6e4*t.getTimezoneOffset()).toISOString().slice(0,10),a=new Date(t.getTime()-6e4*t.getTimezoneOffset()).toISOString().slice(11,16),n=S.date!==s||S.time!==a,r=S.status;n&&"scheduled"===l.status&&(r="rescheduled");let i={date:e,type:S.type,status:r,notes:S.notes||null,patientId:S.patientId,doctorId:S.doctorId},o=await es(l.id,i,D);if(o.success){if(n)if(o.smsError)el.toast.warning(`Appointment rescheduled, but SMS failed: ${o.smsError}`);else{let e=o.smsSent?"Appointment rescheduled and SMS notification sent.":"Appointment rescheduled successfully.";el.toast.success(e)}else el.toast.success("Appointment updated successfully.");x(!1),m.refresh(),d?.()}else el.toast.error(o.error||"Failed to update appointment.")}catch{el.toast.error("An error occurred while updating the appointment.")}finally{p(!1)}}},E=async()=>{if(l){p(!0);try{let e=await es(l.id,{status:"cancelled"});e.success?(el.toast.success("Appointment cancelled successfully."),m.refresh(),d?.()):el.toast.error(e.error||"Failed to cancel appointment.")}catch{el.toast.error("An error occurred while cancelling the appointment.")}finally{p(!1)}}};return(0,t.jsxs)($.Dialog,{open:e,onOpenChange:r,children:[(0,t.jsxs)($.DialogContent,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[(0,t.jsxs)($.DialogHeader,{className:"space-y-4",children:[(0,t.jsx)($.DialogTitle,{children:"Appointment Details"}),u?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:"flex items-start gap-3 py-2",children:[(0,t.jsx)(q.Calendar,{className:"h-5 w-5 text-muted-foreground mt-0.5"}),(0,t.jsx)("div",{className:"flex-1",children:(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,t.jsxs)("div",{className:"grid gap-2",children:[(0,t.jsx)(U.Label,{htmlFor:"date",className:"text-xs",children:"Date"}),(0,t.jsx)(H.Input,{id:"date",type:"date",value:S.date,onChange:e=>C({...S,date:e.target.value}),required:!0})]}),(0,t.jsxs)("div",{className:"grid gap-2",children:[(0,t.jsx)(U.Label,{htmlFor:"time",className:"text-xs",children:"Time"}),(0,t.jsx)(H.Input,{id:"time",type:"time",value:S.time,onChange:e=>C({...S,time:e.target.value}),required:!0})]})]})})]}),(0,t.jsxs)("div",{className:"flex items-start gap-3 py-2",children:[(0,t.jsx)(G.Users,{className:"h-5 w-5 text-muted-foreground mt-0.5"}),(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsx)(U.Label,{className:"text-xs text-muted-foreground mb-1 block",children:"Patient"}),(0,t.jsxs)(n.Select,{value:S.patientId,onValueChange:e=>C({...S,patientId:e}),required:!0,children:[(0,t.jsx)(n.SelectTrigger,{children:(0,t.jsx)(n.SelectValue,{placeholder:"Select patient"})}),(0,t.jsx)(n.SelectContent,{children:f.map(e=>(0,t.jsx)(n.SelectItem,{value:e.id,children:e.name},e.id))})]})]})]}),(0,t.jsxs)("div",{className:"flex items-start gap-3 py-2",children:[(0,t.jsx)(W.Stethoscope,{className:"h-5 w-5 text-muted-foreground mt-0.5"}),(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsx)(U.Label,{className:"text-xs text-muted-foreground mb-1 block",children:"Doctor"}),(0,t.jsxs)(n.Select,{value:S.doctorId,onValueChange:e=>C({...S,doctorId:e}),required:!0,children:[(0,t.jsx)(n.SelectTrigger,{children:(0,t.jsx)(n.SelectValue,{placeholder:"Select doctor"})}),(0,t.jsx)(n.SelectContent,{children:j.map(e=>(0,t.jsx)(n.SelectItem,{value:e.id,children:e.user?.name||"Unknown Doctor"},e.id))})]})]})]}),(0,t.jsxs)("div",{className:"flex items-start gap-3 py-2",children:[(0,t.jsx)(_.Clock,{className:"h-5 w-5 text-muted-foreground mt-0.5"}),(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsx)(U.Label,{className:"text-xs text-muted-foreground mb-1 block",children:"Type"}),(0,t.jsxs)(n.Select,{value:S.type,onValueChange:e=>C({...S,type:e}),required:!0,children:[(0,t.jsx)(n.SelectTrigger,{children:(0,t.jsx)(n.SelectValue,{placeholder:"Select type"})}),(0,t.jsx)(n.SelectContent,{children:y.map(e=>(0,t.jsx)(n.SelectItem,{value:e.name,children:e.displayName||e.name},e.id))})]})]})]}),(0,t.jsxs)("div",{className:"flex items-start gap-3 py-2",children:[(0,t.jsx)(_.Clock,{className:"h-5 w-5 text-muted-foreground mt-0.5"}),(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsx)(U.Label,{className:"text-xs text-muted-foreground mb-1 block",children:"Status"}),(0,t.jsxs)(n.Select,{value:S.status,onValueChange:e=>C({...S,status:e}),required:!0,children:[(0,t.jsx)(n.SelectTrigger,{children:(0,t.jsx)(n.SelectValue,{placeholder:"Select status"})}),(0,t.jsxs)(n.SelectContent,{children:[(0,t.jsx)(n.SelectItem,{value:"scheduled",children:"Scheduled"}),(0,t.jsx)(n.SelectItem,{value:"completed",children:"Completed"}),(0,t.jsx)(n.SelectItem,{value:"cancelled",children:"Cancelled"}),(0,t.jsx)(n.SelectItem,{value:"rescheduled",children:"Rescheduled"})]})]})]})]}),(0,t.jsxs)("div",{className:"flex items-start gap-3 py-2",children:[(0,t.jsx)(K.FileText,{className:"h-5 w-5 text-muted-foreground mt-0.5"}),(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsx)(U.Label,{className:"text-xs text-muted-foreground mb-1 block",children:"Notes"}),(0,t.jsx)(H.Input,{value:S.notes,onChange:e=>C({...S,notes:e.target.value}),placeholder:"Add notes..."})]})]}),(0,t.jsxs)("div",{className:"flex items-center space-x-2 py-2",children:[(0,t.jsx)(z.Checkbox,{id:"send-sms-edit",checked:D,onCheckedChange:e=>k(!0===e)}),(0,t.jsx)(U.Label,{htmlFor:"send-sms-edit",className:"cursor-pointer text-sm",children:"Send SMS notification"})]})]}):(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsx)("div",{className:"space-y-2",children:(0,t.jsxs)("div",{className:"flex items-start gap-3",children:[(0,t.jsxs)("div",{className:"space-y-2 flex-1",children:[(0,t.jsx)(O.Badge,{variant:(e=>{switch(e){case"scheduled":return"default";case"completed":return"secondary";case"cancelled":return"destructive";default:return"outline"}})(l.status),className:"capitalize",children:l.status}),(0,t.jsx)("div",{className:"text-2xl font-semibold",children:`${l.type.charAt(0).toUpperCase()+l.type.slice(1)} - ${l.patient?.name||"Unknown Patient"}`}),(0,t.jsxs)("div",{className:"text-sm text-muted-foreground",children:[(0,i.format)(I,"EEEE, MMMM d")," •"," ",(0,i.format)(I,"h:mm a")," - ",(0,i.format)(P,"h:mm a")]})]}),!c&&(0,t.jsxs)("div",{className:"flex items-center gap-1",children:[(0,t.jsx)(a.Button,{variant:"ghost",size:"icon",onClick:()=>x(!0),disabled:h,"aria-label":"Edit appointment",children:(0,t.jsx)(M.Pencil,{className:"h-4 w-4"})}),(0,t.jsx)(a.Button,{variant:"ghost",size:"icon",onClick:()=>o?.(),disabled:h||!o,"aria-label":"Delete appointment",className:"text-destructive hover:text-destructive",children:(0,t.jsx)(L.Trash2,{className:"h-4 w-4"})})]})]})}),(0,t.jsxs)("div",{className:"flex items-start gap-3",children:[(0,t.jsx)(Y.User,{className:"h-5 w-5 text-muted-foreground mt-0.5"}),(0,t.jsxs)("div",{className:"flex-1 space-y-1",children:[(0,t.jsx)("div",{className:"text-xs text-muted-foreground",children:"Patient"}),(0,t.jsx)("div",{className:"text-sm font-medium",children:l.patient?.name||"Unknown Patient"}),l.patient?.phone&&(0,t.jsx)("div",{className:"text-xs text-muted-foreground",children:l.patient.phone})]})]}),(0,t.jsxs)("div",{className:"flex items-start gap-3",children:[(0,t.jsx)(W.Stethoscope,{className:"h-5 w-5 text-muted-foreground mt-0.5"}),(0,t.jsxs)("div",{className:"flex-1 space-y-1",children:[(0,t.jsx)("div",{className:"text-xs text-muted-foreground",children:"Doctor"}),(0,t.jsx)("div",{className:"text-sm font-medium",children:l.doctor?.user?.name||"Unknown Doctor"}),l.doctor?.specialty&&(0,t.jsx)("div",{className:"text-xs text-muted-foreground",children:l.doctor.specialty})]})]}),(0,t.jsxs)("div",{className:"flex items-start gap-3",children:[(0,t.jsx)(K.FileText,{className:"h-5 w-5 text-muted-foreground mt-0.5"}),(0,t.jsxs)("div",{className:"flex-1 space-y-1",children:[(0,t.jsx)("div",{className:"text-xs text-muted-foreground",children:"Description"}),(0,t.jsx)("div",{className:"text-sm",children:l.notes||"No description provided."})]})]}),(0,t.jsxs)("div",{className:"flex items-start gap-3",children:[(0,t.jsx)(ee.Bell,{className:"h-5 w-5 text-muted-foreground mt-0.5"}),(0,t.jsxs)("div",{className:"flex-1 space-y-1",children:[(0,t.jsx)("div",{className:"text-xs text-muted-foreground",children:"Date and Time"}),(0,t.jsxs)("div",{className:"text-sm",children:[(0,i.format)(I,"EEEE, MMMM d")," • ",(0,i.format)(I,"h:mm a")," ","- ",(0,i.format)(P,"h:mm a")]})]})]})]})]}),!c&&(0,t.jsx)("div",{className:"flex items-center justify-start gap-2 pt-4 mt-4 flex-wrap",children:u?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(a.Button,{variant:"outline",onClick:()=>{if(l){let e=new Date(l.date);C({date:new Date(e.getTime()-6e4*e.getTimezoneOffset()).toISOString().slice(0,10),time:new Date(e.getTime()-6e4*e.getTimezoneOffset()).toISOString().slice(11,16),type:l.type||"",status:l.status||"scheduled",notes:l.notes||"",patientId:l.patientId||"",doctorId:l.doctorId||""})}x(!1)},disabled:h,children:"Cancel"}),(0,t.jsxs)(a.Button,{onClick:F,disabled:h,children:[h&&(0,t.jsx)(X.Loader2,{className:"mr-2 h-4 w-4 animate-spin"}),"Save Changes"]})]}):(0,t.jsx)("div",{className:"flex items-center gap-2",children:"scheduled"===l.status&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(a.Button,{variant:"outline",onClick:()=>{if(l){if("scheduled"!==l.status)return void el.toast.error("Only scheduled appointments can be checked in.");w(!0)}},disabled:h,children:[(0,t.jsx)(Q.CheckCircle2,{className:"mr-2 h-4 w-4"}),"Check In"]}),(0,t.jsxs)(a.Button,{variant:"outline",onClick:()=>{x(!0)},disabled:h,children:[(0,t.jsx)(Z.default,{className:"mr-2 h-4 w-4"}),"Reschedule"]}),(0,t.jsxs)(a.Button,{variant:"outline",onClick:E,disabled:h,className:"text-destructive hover:text-destructive",children:[(0,t.jsx)(J.X,{className:"mr-2 h-4 w-4"}),"Cancel"]})]})})})]}),(0,t.jsx)(eQ,{open:b,onOpenChange:w,appointment:l,onSuccess:()=>{w(!1),r(!1),d?.()}})]})}function e1({data:e}){let[a,n]=(0,s.useState)(null),[r,l]=(0,s.useState)(!1),i=e=>e.map(e=>({...e,onRowClick:()=>{n(e),l(!0)}})),d=e.filter(e=>"scheduled"===e.status),o=e.filter(e=>"rescheduled"===e.status),c=e.filter(e=>"cancelled"===e.status),m=e.filter(e=>"completed"===e.status);return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(P.Tabs,{defaultValue:"pending",className:"w-full",children:[(0,t.jsxs)(P.TabsList,{children:[(0,t.jsxs)(P.TabsTrigger,{value:"pending",children:["Pending (",d.length,")"]}),(0,t.jsxs)(P.TabsTrigger,{value:"rescheduled",children:["Rescheduled (",o.length,")"]}),(0,t.jsxs)(P.TabsTrigger,{value:"cancelled",children:["Cancelled (",c.length,")"]}),(0,t.jsxs)(P.TabsTrigger,{value:"completed",children:["Completed (",m.length,")"]}),(0,t.jsxs)(P.TabsTrigger,{value:"all",children:["All (",e.length,")"]})]}),(0,t.jsx)(P.TabsContent,{value:"pending",className:"mt-4",children:(0,t.jsx)(F.DataTable,{columns:V,data:i(d)})}),(0,t.jsx)(P.TabsContent,{value:"rescheduled",className:"mt-4",children:(0,t.jsx)(F.DataTable,{columns:V,data:i(o)})}),(0,t.jsx)(P.TabsContent,{value:"cancelled",className:"mt-4",children:(0,t.jsx)(F.DataTable,{columns:V,data:i(c)})}),(0,t.jsx)(P.TabsContent,{value:"completed",className:"mt-4",children:(0,t.jsx)(F.DataTable,{columns:V,data:i(m)})}),(0,t.jsx)(P.TabsContent,{value:"all",className:"mt-4",children:(0,t.jsx)(F.DataTable,{columns:V,data:i(e)})})]}),(0,t.jsx)(e0,{open:r,onOpenChange:l,appointment:a})]})}var e4=e.i(107233),e2=e.i(643531),e5=e.i(344523),e6=e.i(753751),e3=e.i(59377);let e8=(0,et.createServerReference)("784653c2201d600df74b00262e169e63a836a5e1a8",et.callServer,void 0,et.findSourceMapURL,"createAppointment");function e7({open:e,onOpenChange:r,defaultDate:l,trigger:i}){let[d,o]=(0,s.useState)(!1),[c,m]=(0,s.useState)(!1),u=void 0!==e,x=u?e:d,h=e=>{e||(b(!1),C("")),u?r?.(e):o(e)},[p,f]=(0,s.useState)([]),[g,j]=(0,s.useState)([]),[v,y]=(0,s.useState)([]),[N,b]=(0,s.useState)(!1),[w,C]=(0,s.useState)(""),[D,k]=(0,s.useState)(!1);async function T(e){e.preventDefault(),m(!0);let t=new FormData(e.currentTarget),s=t.get("date"),a=t.get("time"),n=new Date(`${s}T${a}`),r={patientId:t.get("patientId"),doctorId:t.get("doctorId"),date:n,type:t.get("type"),status:"scheduled",notes:t.get("notes")},l=await e8(r,N,s,a);if(m(!1),l.success)if(h(!1),l.smsError)el.toast.warning(`Appointment scheduled, but SMS failed: ${l.smsError}`);else{let e=l.smsSent?"Appointment scheduled and SMS notification sent to patient.":"Appointment scheduled.";el.toast.success(e)}else el.toast.error(l.error||"Something went wrong.")}return(0,s.useEffect)(()=>{x&&((0,ea.getPatients)().then(e=>{e.success&&f(e.data||[])}),(0,en.getDoctors)().then(e=>{e.success&&j(e.data||[])}),er().then(e=>{e.success&&y(e.data||[])}))},[x]),(0,t.jsxs)($.Dialog,{open:x,onOpenChange:h,children:[(0,t.jsx)($.DialogTrigger,{asChild:!0,children:i||(0,t.jsxs)(a.Button,{children:[(0,t.jsx)(e4.Plus,{className:"mr-2 h-4 w-4"}),"New Appointment"]})}),(0,t.jsx)($.DialogContent,{className:"sm:max-w-[425px]",children:(0,t.jsxs)("form",{onSubmit:T,children:[(0,t.jsxs)($.DialogHeader,{children:[(0,t.jsx)($.DialogTitle,{children:"New Appointment"}),(0,t.jsx)($.DialogDescription,{children:"Schedule a new appointment."})]}),(0,t.jsxs)("div",{className:"grid gap-4 py-4",children:[(0,t.jsxs)("div",{className:"grid gap-2",children:[(0,t.jsx)(U.Label,{htmlFor:"patientId",children:"Patient"}),(0,t.jsxs)(e3.Popover,{open:D,onOpenChange:k,children:[(0,t.jsx)(e3.PopoverTrigger,{asChild:!0,children:(0,t.jsxs)(a.Button,{variant:"outline",role:"combobox","aria-expanded":D,className:"w-full justify-between",children:[w?p.find(e=>e.id===w)?.name:"Select patient",(0,t.jsx)(e5.ChevronsUpDown,{className:"ml-2 h-4 w-4 shrink-0 opacity-50"})]})}),(0,t.jsx)(e3.PopoverContent,{className:"w-full p-0",children:(0,t.jsxs)(e6.Command,{children:[(0,t.jsx)(e6.CommandInput,{placeholder:"Search patients..."}),(0,t.jsxs)(e6.CommandList,{children:[(0,t.jsx)(e6.CommandEmpty,{children:"No patient found."}),(0,t.jsx)(e6.CommandGroup,{children:p.map(e=>(0,t.jsxs)(e6.CommandItem,{value:e.name,onSelect:()=>{C(e.id),k(!1)},children:[(0,t.jsx)(e2.Check,{className:(0,S.cn)("mr-2 h-4 w-4",w===e.id?"opacity-100":"opacity-0")}),e.name]},e.id))})]})]})})]}),(0,t.jsx)("input",{type:"hidden",name:"patientId",value:w,required:!0})]}),(0,t.jsxs)("div",{className:"grid gap-2",children:[(0,t.jsx)(U.Label,{htmlFor:"doctorId",children:"Doctor"}),(0,t.jsxs)(n.Select,{name:"doctorId",required:!0,children:[(0,t.jsx)(n.SelectTrigger,{children:(0,t.jsx)(n.SelectValue,{placeholder:"Select doctor"})}),(0,t.jsx)(n.SelectContent,{children:g.map(e=>(0,t.jsx)(n.SelectItem,{value:e.id,children:e.user?.name||"Unknown Doctor"},e.id))})]})]}),(0,t.jsxs)("div",{className:"grid gap-2",children:[(0,t.jsx)(U.Label,{htmlFor:"date",children:"Date"}),(0,t.jsx)(H.Input,{id:"date",name:"date",type:"date",required:!0,defaultValue:l?new Date(l.getTime()-6e4*l.getTimezoneOffset()).toISOString().slice(0,10):void 0})]}),(0,t.jsxs)("div",{className:"grid gap-2",children:[(0,t.jsx)(U.Label,{htmlFor:"time",children:"Time"}),(0,t.jsx)(H.Input,{id:"time",name:"time",type:"time",required:!0,defaultValue:l?new Date(l.getTime()-6e4*l.getTimezoneOffset()).toISOString().slice(11,16):void 0})]}),(0,t.jsxs)("div",{className:"grid gap-2",children:[(0,t.jsx)(U.Label,{htmlFor:"type",children:"Type"}),(0,t.jsxs)(n.Select,{name:"type",defaultValue:"consultation",children:[(0,t.jsx)(n.SelectTrigger,{children:(0,t.jsx)(n.SelectValue,{placeholder:"Select type"})}),(0,t.jsx)(n.SelectContent,{children:v.map(e=>(0,t.jsx)(n.SelectItem,{value:e.name,children:e.displayName||e.name},e.id))})]})]}),(0,t.jsxs)("div",{className:"grid gap-2",children:[(0,t.jsx)(U.Label,{htmlFor:"notes",children:"Notes"}),(0,t.jsx)(H.Input,{id:"notes",name:"notes"})]}),(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)(z.Checkbox,{id:"send-sms",checked:N,onCheckedChange:e=>b(!0===e)}),(0,t.jsx)(U.Label,{htmlFor:"send-sms",className:"cursor-pointer text-sm",children:"Send SMS notification to patient"})]})]}),(0,t.jsx)($.DialogFooter,{children:(0,t.jsxs)(a.Button,{type:"submit",disabled:c,children:[c&&(0,t.jsx)(X.Loader2,{className:"mr-2 h-4 w-4 animate-spin"}),"Schedule"]})})]})})]})}var e9=e.i(223622);let te=(0,et.createServerReference)("405fee687efdeaa4b5d3d691bae4251a802b084caa",et.callServer,void 0,et.findSourceMapURL,"createUnavailability");function tt({currentDoctorId:e,currentDoctorName:r,isDoctor:l=!1}={}){let[i,d]=(0,s.useState)(!1),[o,c]=(0,s.useState)(!1),[m,u]=(0,s.useState)(!1),[x,h]=(0,s.useState)([]),[p,f]=(0,s.useState)(!1),[g,j]=(0,s.useState)(l&&e?e:"");async function v(e){let t,s;e.preventDefault(),c(!0);let a=new FormData(e.currentTarget),n=a.get("date");if(p)t=new Date(`${n}T08:00`),s=new Date(`${n}T20:00`);else{let e=a.get("startTime"),r=a.get("endTime");t=new Date(`${n}T${e}`),s=new Date(`${n}T${r}`)}let r={doctorId:g,startTime:t,endTime:s,reason:a.get("reason")},l=await te(r);c(!1),l.success?(d(!1),f(!1),j(""),el.toast.success("Unavailability blocked.")):el.toast.error(l.error||"Failed to block time.")}return(0,s.useLayoutEffect)(()=>{l&&e&&j(e)},[l,e]),(0,s.useEffect)(()=>{if(!i)return;let e=!0;return(async()=>{u(!0);try{let t=await (0,en.getDoctors)();if(!e)return;t.success&&h(t.data||[])}catch{}finally{e&&u(!1)}})(),()=>{e=!1}},[i]),(0,t.jsxs)($.Dialog,{open:i,onOpenChange:e=>{d(e),e||(f(!1),j(""))},children:[(0,t.jsx)($.DialogTrigger,{asChild:!0,children:(0,t.jsxs)(a.Button,{variant:"secondary",children:[(0,t.jsx)(e9.Ban,{className:"mr-2 h-4 w-4"}),"Block Time"]})}),(0,t.jsx)($.DialogContent,{className:"sm:max-w-[425px]",children:(0,t.jsxs)("form",{onSubmit:v,children:[(0,t.jsxs)($.DialogHeader,{children:[(0,t.jsx)($.DialogTitle,{children:"Block Doctor Availability"}),(0,t.jsx)($.DialogDescription,{children:"Prevent appointments during specific times."})]}),(0,t.jsxs)("div",{className:"grid gap-4 py-4",children:[(0,t.jsxs)("div",{className:"grid grid-cols-4 items-center gap-4",children:[(0,t.jsxs)(U.Label,{htmlFor:"doctorId",className:"text-right",children:["Doctor",l&&(0,t.jsx)("span",{className:"block text-xs text-muted-foreground font-normal mt-1",children:"(Auto-assigned)"})]}),(0,t.jsxs)("div",{className:"col-span-3 space-y-1",children:[m?(0,t.jsx)("div",{className:"col-span-3 h-10 flex items-center px-3 border rounded-md bg-muted",children:(0,t.jsx)("span",{className:"text-sm text-muted-foreground",children:"Loading doctors..."})}):l?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(H.Input,{type:"text",value:r||"",disabled:!0,className:"bg-muted cursor-not-allowed"}),(0,t.jsx)("input",{type:"hidden",name:"doctorId",value:g||""})]}):(0,t.jsxs)(n.Select,{name:"doctorId",required:!0,value:g||void 0,onValueChange:j,children:[(0,t.jsx)(n.SelectTrigger,{children:(0,t.jsx)(n.SelectValue,{placeholder:"Select doctor"})}),(0,t.jsx)(n.SelectContent,{children:x.map(e=>(0,t.jsx)(n.SelectItem,{value:e.id,children:e.user?.name||"Unknown Doctor"},e.id))})]},`doctor-select-${g}`),l&&(0,t.jsx)("p",{className:"text-xs text-muted-foreground",children:"Blocking time for your schedule"})]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-4 items-center gap-4",children:[(0,t.jsx)(U.Label,{htmlFor:"date",className:"text-right",children:"Date"}),(0,t.jsx)(H.Input,{id:"date",name:"date",type:"date",className:"col-span-3",required:!0})]}),(0,t.jsxs)("div",{className:"grid grid-cols-4 items-center gap-4",children:[(0,t.jsx)("div",{className:"text-right"}),(0,t.jsxs)("div",{className:"col-span-3 flex items-center space-x-2",children:[(0,t.jsx)(z.Checkbox,{id:"allDay",checked:p,onCheckedChange:e=>f(e)}),(0,t.jsx)(U.Label,{htmlFor:"allDay",className:"text-sm font-normal cursor-pointer",children:"All day (8 AM - 8 PM)"})]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-4 items-center gap-4",children:[(0,t.jsx)(U.Label,{htmlFor:"startTime",className:"text-right",children:"Start"}),(0,t.jsx)(H.Input,{id:"startTime",name:"startTime",type:"time",className:"col-span-3",required:!p,disabled:p,defaultValue:"08:00"})]}),(0,t.jsxs)("div",{className:"grid grid-cols-4 items-center gap-4",children:[(0,t.jsx)(U.Label,{htmlFor:"endTime",className:"text-right",children:"End"}),(0,t.jsx)(H.Input,{id:"endTime",name:"endTime",type:"time",className:"col-span-3",required:!p,disabled:p,defaultValue:"20:00"})]}),(0,t.jsxs)("div",{className:"grid grid-cols-4 items-center gap-4",children:[(0,t.jsx)(U.Label,{htmlFor:"reason",className:"text-right",children:"Reason"}),(0,t.jsx)(H.Input,{id:"reason",name:"reason",placeholder:"e.g. Vacation, Surgery",className:"col-span-3"})]})]}),(0,t.jsx)($.DialogFooter,{children:(0,t.jsxs)(a.Button,{type:"submit",disabled:o,children:[o&&(0,t.jsx)(X.Loader2,{className:"mr-2 h-4 w-4 animate-spin"}),"Block Time"]})})]})})]})}var ts=e.i(330009);let ta=(0,et.createServerReference)("40437aba8178d314cbd890ae79ff2649670af12909",et.callServer,void 0,et.findSourceMapURL,"deleteUnavailability");function tn({open:e,onOpenChange:n,unavailability:r}){let l=(0,T.useRouter)(),[d,o]=(0,s.useState)(!1),[c,m]=(0,s.useState)(!1);if(!r)return null;let u=new Date(r.startTime),x=new Date(r.endTime),h=async()=>{o(!0);try{let e=await ta(r.id);e.success?(el.toast.success("Blocked time removed successfully"),l.refresh(),n(!1),m(!1)):el.toast.error(e.error||"Failed to remove blocked time")}catch(e){console.error("Error deleting unavailability:",e),el.toast.error("An error occurred while removing blocked time")}finally{o(!1)}};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)($.Dialog,{open:e,onOpenChange:n,children:(0,t.jsxs)($.DialogContent,{className:"max-w-md",children:[(0,t.jsxs)($.DialogHeader,{children:[(0,t.jsx)($.DialogTitle,{children:"Blocked Time"}),(0,t.jsx)($.DialogDescription,{children:"View and manage blocked time slot"})]}),(0,t.jsxs)("div",{className:"space-y-4 py-4",children:[(0,t.jsxs)("div",{className:"flex items-start gap-3",children:[(0,t.jsx)(Y.User,{className:"h-5 w-5 text-muted-foreground mt-0.5"}),(0,t.jsxs)("div",{className:"flex-1 space-y-1",children:[(0,t.jsx)("div",{className:"text-xs text-muted-foreground",children:"Doctor"}),(0,t.jsx)("div",{className:"text-sm font-medium",children:r.doctor?.user?.name||"Unknown Doctor"})]})]}),(0,t.jsxs)("div",{className:"flex items-start gap-3",children:[(0,t.jsx)(q.Calendar,{className:"h-5 w-5 text-muted-foreground mt-0.5"}),(0,t.jsxs)("div",{className:"flex-1 space-y-1",children:[(0,t.jsx)("div",{className:"text-xs text-muted-foreground",children:"Date"}),(0,t.jsx)("div",{className:"text-sm font-medium",children:(0,i.format)(u,"EEEE, MMMM d, yyyy")})]})]}),(0,t.jsxs)("div",{className:"flex items-start gap-3",children:[(0,t.jsx)(_.Clock,{className:"h-5 w-5 text-muted-foreground mt-0.5"}),(0,t.jsxs)("div",{className:"flex-1 space-y-1",children:[(0,t.jsx)("div",{className:"text-xs text-muted-foreground",children:"Time"}),(0,t.jsxs)("div",{className:"text-sm font-medium",children:[(0,i.format)(u,"h:mm a")," - ",(0,i.format)(x,"h:mm a")]})]})]}),r.reason&&(0,t.jsxs)("div",{className:"flex items-start gap-3",children:[(0,t.jsx)("div",{className:"h-5 w-5 text-muted-foreground mt-0.5"}),(0,t.jsxs)("div",{className:"flex-1 space-y-1",children:[(0,t.jsx)("div",{className:"text-xs text-muted-foreground",children:"Reason"}),(0,t.jsx)("div",{className:"text-sm",children:r.reason})]})]})]}),(0,t.jsxs)("div",{className:"flex items-center justify-end gap-2 pt-4 border-t",children:[(0,t.jsx)(a.Button,{variant:"outline",onClick:()=>n(!1),children:"Close"}),(0,t.jsxs)(a.Button,{variant:"destructive",onClick:()=>m(!0),disabled:d,children:[(0,t.jsx)(L.Trash2,{className:"mr-2 h-4 w-4"}),"Remove Block"]})]})]})}),(0,t.jsx)(ts.AlertDialog,{open:c,onOpenChange:m,children:(0,t.jsxs)(ts.AlertDialogContent,{children:[(0,t.jsxs)(ts.AlertDialogHeader,{children:[(0,t.jsx)(ts.AlertDialogTitle,{children:"Remove Blocked Time?"}),(0,t.jsx)(ts.AlertDialogDescription,{children:"This will permanently remove this blocked time slot from the calendar. This action cannot be undone."})]}),(0,t.jsxs)(ts.AlertDialogFooter,{children:[(0,t.jsx)(ts.AlertDialogCancel,{disabled:d,children:"Cancel"}),(0,t.jsxs)(ts.AlertDialogAction,{onClick:h,disabled:d,className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:[d&&(0,t.jsx)(X.Loader2,{className:"mr-2 h-4 w-4 animate-spin"}),"Remove"]})]})]})})]})}function tr({appointments:e,unavailability:n,canCreateAppointments:r=!0,currentDoctorId:l,currentDoctorName:i}){let[d,o]=(0,s.useState)(!1),[c,m]=(0,s.useState)(void 0),[u,x]=(0,s.useState)(null),[h,p]=(0,s.useState)(!1),[f,g]=(0,s.useState)(null),[j,v]=(0,s.useState)(!1);return(0,t.jsxs)("div",{className:"flex flex-col gap-6",children:[(0,t.jsx)("div",{className:"flex items-center justify-between",children:(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-3xl font-bold tracking-tight",children:"Appointments"}),(0,t.jsx)("p",{className:"text-muted-foreground",children:"Schedule and manage appointments."})]})}),(0,t.jsxs)(P.Tabs,{defaultValue:"calendar",className:"w-full",children:[(0,t.jsxs)(P.TabsList,{children:[(0,t.jsx)(P.TabsTrigger,{value:"calendar",children:"Calendar"}),(0,t.jsx)(P.TabsTrigger,{value:"list",children:"All Appointments"})]}),(0,t.jsxs)(P.TabsContent,{value:"calendar",className:"mt-4 flex flex-col gap-4",children:[(0,t.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,t.jsx)(tt,{currentDoctorId:l,currentDoctorName:i,isDoctor:!!l}),r&&(0,t.jsx)(e7,{open:d,onOpenChange:e=>{o(e),e||m(void 0)},defaultDate:c,trigger:(0,t.jsxs)(a.Button,{onClick:()=>o(!0),children:[(0,t.jsx)(e4.Plus,{className:"mr-2 h-4 w-4"}),"New Appointment"]})})]}),(0,t.jsx)(I,{appointments:e,unavailability:n,onDateClick:r?e=>{r&&(m(e),o(!0))}:void 0,onAppointmentClick:e=>{x(e),p(!0)},onUnavailabilityClick:e=>{g(e),v(!0)}})]}),(0,t.jsx)(P.TabsContent,{value:"list",className:"mt-4",children:(0,t.jsx)(e1,{data:e})})]}),(0,t.jsx)(e0,{open:h,onOpenChange:p,appointment:u,readOnly:!r}),(0,t.jsx)(tn,{open:j,onOpenChange:v,unavailability:f})]})}e.s(["AppointmentsShell",()=>tr],796506)}]);