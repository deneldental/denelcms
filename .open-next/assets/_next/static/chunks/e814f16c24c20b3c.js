(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,624819,e=>{"use strict";var a=e.i(247167),t=e.i(843476),n=e.i(271645),s=e.i(652080),l=e.i(846696),i=e.i(275117),r=e.i(522016),d=e.i(63270),c=e.i(970065),o=e.i(994179),m=e.i(269035),u=e.i(127341),x=e.i(947627),h=e.i(23750),p=e.i(184762),j=e.i(62870),f=e.i(531278),g=e.i(361839),g=g,y=e.i(451477),y=y,v=e.i(541071),b=e.i(286536),N=e.i(788699),P=e.i(727612),C=e.i(303281),w=e.i(618566),T=e.i(167881),D=e.i(630374),S=e.i(10708),I=e.i(335883),A=e.i(107233),M=e.i(95187);let F=(0,M.createServerReference)("403cfb106f53f9d5cb400406fdadfd3f16c6fc129f",M.callServer,void 0,M.findSourceMapURL,"createPaymentPlan"),B=(0,M.createServerReference)("6057d70a3357d0d6543bdc639c8fcaa1e17cd6e90d",M.callServer,void 0,M.findSourceMapURL,"updatePaymentPlan");var k=e.i(968806);let R=(0,M.createServerReference)("008645655b9748298417233b285f46ff9839005cce",M.callServer,void 0,M.findSourceMapURL,"getDefaultPaymentPlanTemplate");var H=e.i(131343),O=e.i(905838);function L({patientId:e,existingPlan:a,onSuccess:s,isAdmin:i=!1}){let[r,d]=(0,n.useState)(!1),[c,o]=(0,n.useState)(!1),[m,u]=(0,n.useState)([]),[x,g]=(0,n.useState)(""),[y,v]=(0,n.useState)(null),[b,P]=(0,n.useState)([]),[C,w]=(0,n.useState)(""),[M,L]=(0,n.useState)([]),[E,U]=(0,n.useState)("fixed"),[z,V]=(0,n.useState)(""),q=(0,n.useCallback)(async()=>{let e=await (0,k.getPaymentPlanTemplates)();if(e.success&&e.data){let t=e.data.filter(e=>e.isActive);if(u(t),!a&&t.length>0){let e=await R();e.success&&e.data?(g(e.data.id),v(e.data)):t.length>0&&(g(t[0].id),v(t[0]))}else if(a?.templateId){let e=t.find(e=>e.id===a.templateId);e&&v(e)}}},[a]),_=async()=>{let e=await (0,H.getTreatmentTypes)();e.success&&e.data&&L(e.data)};(0,n.useEffect)(()=>{r&&(q(),_(),a?.templateId&&g(a.templateId),w(a?.notes||""),P([]),w(""),U(a?.type==="flexible"?"flexible":"fixed"),V(a?.totalAmount?.toString()||""))},[r,a,q]);let $=async t=>{t.preventDefault(),o(!0);try{let t;if("fixed"===E&&!y){l.toast.error("Please select a payment plan template"),o(!1);return}if("flexible"===E&&(!z||0>=parseFloat(z))){l.toast.error("Please enter a valid total amount"),o(!1);return}if(0===b.length){l.toast.error("Please select at least one treatment type"),o(!1);return}let n=M.filter(e=>b.includes(e.id)).map(e=>e.displayName||e.name).join(", ");C.trim()&&(n=`${n} - ${C.trim()}`);let i={patientId:e,type:E,templateId:"fixed"===E?y?.id:void 0,totalAmount:"fixed"===E?y.totalAmount:parseFloat(z),amountPerInstallment:"fixed"===E?y.amountPerInstallment:void 0,paymentFrequency:"fixed"===E?y.paymentFrequency:void 0,startDate:new Date,status:"flexible"===E?"outstanding":"activated",notes:n};if(a){let e=M.filter(e=>b.includes(e.id)).map(e=>e.displayName||e.name).join(", ");C.trim()&&(e=`${e} - ${C.trim()}`),t=await B(a.id,{type:E,templateId:"fixed"===E?y?.id:void 0,totalAmount:"fixed"===E?y.totalAmount:parseFloat(z),amountPerInstallment:"fixed"===E?y?.amountPerInstallment:void 0,paymentFrequency:"fixed"===E?y?.paymentFrequency:void 0,notes:e})}else t=await F(i);t.success?(l.toast.success(a?"Payment plan updated successfully":"Payment plan created successfully"),d(!1),s?.()):l.toast.error(t.error||"Failed to save payment plan")}catch{l.toast.error("An error occurred while saving the payment plan")}finally{o(!1)}};return(0,t.jsx)(t.Fragment,{children:(0,t.jsxs)(D.Dialog,{open:r,onOpenChange:d,children:[(0,t.jsx)(D.DialogTrigger,{asChild:!0,children:(0,t.jsx)(T.Button,{variant:a?"outline":"default",disabled:!!a&&!i,children:a?(0,t.jsx)(t.Fragment,{children:i?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(N.Pencil,{className:"mr-2 h-4 w-4"}),"Change Payment Plan (Admin Only)"]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(N.Pencil,{className:"mr-2 h-4 w-4"}),"View Payment Plan"]})}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(A.Plus,{className:"mr-2 h-4 w-4"}),"Select Payment Plan"]})})}),(0,t.jsx)(D.DialogContent,{className:"sm:max-w-[500px]",children:(0,t.jsxs)("form",{onSubmit:$,children:[(0,t.jsxs)(D.DialogHeader,{children:[(0,t.jsx)(D.DialogTitle,{children:a?i?"Change Payment Plan (Admin Only)":"Payment Plan Details":"Select Payment Plan"}),(0,t.jsx)(D.DialogDescription,{children:a?i?"Only administrators can change the payment plan once it has been selected.":"This payment plan has been locked. Only administrators can make changes.":"Select a payment plan template to assign to this patient. Once selected, only administrators can change it."})]}),(0,t.jsxs)("div",{className:"grid gap-4 py-4",children:[(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsx)(S.Label,{children:"Plan Type *"}),(0,t.jsxs)("div",{className:"flex gap-4",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)("input",{type:"radio",id:"fixed",name:"planType",value:"fixed",checked:"fixed"===E,onChange:()=>U("fixed"),disabled:!!a&&!i,className:"h-4 w-4"}),(0,t.jsx)(S.Label,{htmlFor:"fixed",className:"font-normal cursor-pointer",children:"Fixed Schedule"})]}),(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)("input",{type:"radio",id:"flexible",name:"planType",value:"flexible",checked:"flexible"===E,onChange:()=>U("flexible"),disabled:!!a&&!i,className:"h-4 w-4"}),(0,t.jsx)(S.Label,{htmlFor:"flexible",className:"font-normal cursor-pointer",children:"Flexible Installments"})]})]}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:"fixed"===E?"Fixed schedule with regular installments":"Flexible payments without fixed schedule"})]}),"fixed"===E&&(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(S.Label,{htmlFor:"template",children:"Payment Plan Template *"}),(0,t.jsxs)(j.Select,{value:x,onValueChange:e=>{g(e),v(m.find(a=>a.id===e)||null)},required:!0,disabled:!!a&&!i,children:[(0,t.jsx)(j.SelectTrigger,{children:(0,t.jsx)(j.SelectValue,{placeholder:"Select a template"})}),(0,t.jsx)(j.SelectContent,{children:m.map(e=>(0,t.jsxs)(j.SelectItem,{value:e.id,children:[e.name," ",e.isDefault&&"(Default)"]},e.id))})]}),a&&!i&&(0,t.jsx)("p",{className:"text-sm text-muted-foreground mt-1",children:"Payment plan is locked. Contact an administrator to make changes."})]}),"flexible"===E&&(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(S.Label,{htmlFor:"flexibleAmount",children:"Total Amount *"}),(0,t.jsx)(h.Input,{id:"flexibleAmount",type:"text",inputMode:"decimal",placeholder:"Enter total amount (e.g., 3000)",value:z,onChange:e=>{V(e.target.value.replace(/[^\d.]/g,""))},disabled:!!a&&!i,required:!0}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:"Enter the total amount to be paid without fixed installments"})]}),y&&"fixed"===E&&(0,t.jsx)("div",{className:"rounded-lg border p-4 space-y-2 bg-muted/50",children:(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"text-muted-foreground",children:"Total Amount:"}),(0,t.jsx)("p",{className:"font-semibold",children:(0,O.formatCurrency)(y.totalAmount)})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"text-muted-foreground",children:"Per Installment:"}),(0,t.jsx)("p",{className:"font-semibold",children:(0,O.formatCurrency)(y.amountPerInstallment)})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"text-muted-foreground",children:"Frequency:"}),(0,t.jsx)("p",{className:"capitalize",children:y.paymentFrequency})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"text-muted-foreground",children:"Start Date:"}),(0,t.jsx)("p",{children:new Date().toLocaleDateString()})]})]})}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(S.Label,{children:"Treatment Types *"}),(0,t.jsx)(I.TreatmentTypesMultiSelect,{value:b,onChange:P,placeholder:"Select treatment types...",disabled:!!a&&!i})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(S.Label,{htmlFor:"additionalNotes",children:"Additional Notes (Optional)"}),(0,t.jsx)(p.Textarea,{id:"additionalNotes",value:C,onChange:e=>w(e.target.value),placeholder:"Additional notes about this payment plan",disabled:!!a&&!i})]})]}),(0,t.jsxs)(D.DialogFooter,{children:[(0,t.jsx)(T.Button,{type:"button",variant:"outline",onClick:()=>d(!1),disabled:c,children:"Cancel"}),(0,t.jsxs)(T.Button,{type:"submit",disabled:c||!y||0===b.length||!!a&&!i,children:[c&&(0,t.jsx)(f.Loader2,{className:"mr-2 h-4 w-4 animate-spin"}),a?i?"Change Plan":"Locked":"Select Plan"]})]})]})})]})})}let E=(0,M.createServerReference)("401600e596148ab44b12cea5b7828cdf871ca8ffb2",M.callServer,void 0,M.findSourceMapURL,"pausePaymentPlan"),U=(0,M.createServerReference)("40b296f3907dff36584146d4cdca660a8087289632",M.callServer,void 0,M.findSourceMapURL,"unpausePaymentPlan");var z=e.i(463415),V=e.i(643011),q=e.i(401851),_=e.i(657688);function $({open:e,onOpenChange:a,record:n}){return n?(0,t.jsx)(D.Dialog,{open:e,onOpenChange:a,children:(0,t.jsxs)(D.DialogContent,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[(0,t.jsxs)(D.DialogHeader,{children:[(0,t.jsx)(D.DialogTitle,{children:"Medical Record Details"}),(0,t.jsx)(D.DialogDescription,{children:"View complete medical record information"})]}),(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"Date"}),(0,t.jsx)("p",{className:"text-sm",children:(0,q.format)(new Date(n.date||n.createdAt),"MMMM d, yyyy")})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"Doctor"}),(0,t.jsx)("p",{className:"text-sm",children:n.doctor?.user?.name||"Unknown"})]})]}),(0,t.jsx)(m.Separator,{}),n.complaint&&(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm font-medium text-muted-foreground mb-2",children:"Chief Complaint"}),(0,t.jsx)("p",{className:"text-sm whitespace-pre-wrap",children:n.complaint})]}),n.examination&&(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm font-medium text-muted-foreground mb-2",children:"Examination"}),(0,t.jsx)("p",{className:"text-sm whitespace-pre-wrap",children:n.examination})]}),n.diagnosis&&(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm font-medium text-muted-foreground mb-2",children:"Diagnosis"}),(0,t.jsx)("p",{className:"text-sm whitespace-pre-wrap",children:n.diagnosis})]}),n.treatment&&(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm font-medium text-muted-foreground mb-2",children:"Treatment Plan"}),(0,t.jsx)("p",{className:"text-sm whitespace-pre-wrap",children:n.treatment})]}),n.prescription&&(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm font-medium text-muted-foreground mb-2",children:"Prescription"}),(0,t.jsx)("p",{className:"text-sm whitespace-pre-wrap",children:n.prescription})]}),n.notes&&(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm font-medium text-muted-foreground mb-2",children:"Additional Notes"}),(0,t.jsx)("p",{className:"text-sm whitespace-pre-wrap",children:n.notes})]}),n.attachments&&(()=>{try{let e=JSON.parse(n.attachments);if(Array.isArray(e)&&e.length>0)return(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm font-medium text-muted-foreground mb-2",children:"Images"}),(0,t.jsx)("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-4",children:e.map((e,a)=>(0,t.jsx)("div",{className:"relative group",children:(0,t.jsx)("div",{className:"aspect-square rounded-lg overflow-hidden border border-muted",children:(0,t.jsx)(_.default,{src:e,alt:`Medical record image ${a+1}`,width:200,height:200,className:"w-full h-full object-cover cursor-pointer hover:opacity-90 transition-opacity",unoptimized:!0,onClick:()=>{let t=window.open();t&&t.document.write(`
                                                                        <html>
                                                                            <head><title>Image ${a+1}</title></head>
                                                                            <body style="margin:0;display:flex;justify-content:center;align-items:center;height:100vh;background:#000">
                                                                                <img src="${e}" style="max-width:100%;max-height:100%;object-fit:contain;" />
                                                                            </body>
                                                                        </html>
                                                                    `)}})})},a))})]})}catch{}return null})()]})]})}):null}var G=e.i(160625),K=e.i(133308),X=e.i(685946),J=e.i(762332),Q=e.i(416355),W=e.i(740636),Y=e.i(908339);function Z({label:e,value:a,onSave:s,type:l="text",options:i,placeholder:r,className:d=""}){let[c,o]=(0,n.useState)(!1),[m,u]=(0,n.useState)(a||""),[x,g]=(0,n.useState)(!1),y=(0,n.useRef)(null);(0,n.useEffect)(()=>{u(a||"")},[a]),(0,n.useEffect)(()=>{c&&y.current&&(y.current.focus(),("text"===l||"email"===l||"tel"===l)&&y.current.select())},[c,l]);let v=async()=>{if(m===(a||""))return void o(!1);g(!0);try{await s(m),o(!1)}catch{}finally{g(!1)}},b=e=>{"Enter"===e.key&&"textarea"!==l?(e.preventDefault(),v()):"Escape"===e.key&&(u(a||""),o(!1))};return c?(0,t.jsxs)("div",{className:d,children:[(0,t.jsx)("p",{className:"text-sm font-medium text-muted-foreground mb-1",children:e}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:["textarea"===l?(0,t.jsx)(p.Textarea,{ref:y,value:m,onChange:e=>u(e.target.value),onBlur:v,onKeyDown:b,placeholder:r,className:"flex-1",disabled:x}):"select"===l&&i?(0,t.jsxs)(j.Select,{value:m,onValueChange:async e=>{u(e),g(!0);try{await s(e),o(!1)}catch{}finally{g(!1)}},disabled:x,children:[(0,t.jsx)(j.SelectTrigger,{className:"flex-1",children:(0,t.jsx)(j.SelectValue,{placeholder:r})}),(0,t.jsx)(j.SelectContent,{children:i.map(e=>(0,t.jsx)(j.SelectItem,{value:e.value,children:e.label},e.value))})]}):(0,t.jsx)(h.Input,{ref:y,type:l,value:m,onChange:e=>u(e.target.value),onBlur:v,onKeyDown:b,placeholder:r,className:"flex-1",disabled:x}),x&&(0,t.jsx)(f.Loader2,{className:"h-4 w-4 animate-spin text-muted-foreground"})]})]}):(0,t.jsxs)("div",{className:`cursor-pointer hover:bg-muted/50 rounded-md p-1 -m-1 transition-colors ${d}`,onClick:()=>o(!0),children:[(0,t.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:e}),(0,t.jsx)("p",{className:"font-medium",children:a||"-"})]})}function ee({patient:e,medicalRecords:h,payments:p,paymentPlan:j,isAdmin:f=!1,canViewMedicalRecords:D=!1,canEdit:S=!0}){let I=(0,w.useRouter)(),[A,M]=(0,n.useState)(e),[F,B]=(0,n.useState)(j),k=p.filter(e=>!e.paymentPlanId),R=p.filter(e=>e.paymentPlanId),[H,O]=(0,n.useState)(null),[_,ee]=(0,n.useState)(!1),[ea,et]=(0,n.useState)(!1),[en,es]=(0,n.useState)(!1),[el,ei]=(0,n.useState)(!1),[er,ed]=(0,n.useState)(null),[ec,eo]=(0,n.useState)(!1),[em,eu]=(0,n.useState)(!1),ex=async(e,a)=>{try{let t=a;"dob"===e&&a&&(t=new Date(a)),("isChild"===e||"isOrtho"===e)&&(t="true"===a||"1"===a);let n=await (0,s.updatePatient)(A.id,{[e]:t});if(n.success)M(a=>({...a,[e]:t})),l.toast.success("Patient updated successfully"),I.refresh();else throw l.toast.error(n.error||"Failed to update patient"),Error(n.error||"Failed to update patient")}catch{}},eh=async()=>{if(A.id){let e=await (0,J.getPaymentPlanByPatientId)(A.id);e.success&&e.data&&B(e.data)}I.refresh()},ep=async()=>{if(H){eo(!0);try{let e=await (0,V.deleteMedicalRecord)(H.id);e.success?(l.toast.success("Medical record deleted successfully"),es(!1),O(null),I.refresh()):l.toast.error(e.error||"Failed to delete medical record")}catch{l.toast.error("An error occurred while deleting the medical record")}finally{eo(!1)}}},ej=async e=>{let t,n,s,i=e.patient,r=i?.name||A.name;if(!r)return l.toast.error("Patient information not available"),null;if(e.paymentPlanId&&e.patientId)if(null!==e.balance&&void 0!==e.balance){n=e.balance;let a=await (0,J.getPaymentPlanByPatientId)(e.patientId);a.success&&a.data&&(t=a.data.totalAmount)}else{let[a,s]=await Promise.all([(0,J.getPaymentPlanByPatientId)(e.patientId),(0,Q.getPaymentsByPatientId)(e.patientId)]);if(a.success&&a.data){t=a.data.totalAmount;let e=(s.success?s.data.filter(e=>"completed"===e.status&&e.paymentPlanId===a.data?.id):[]).reduce((e,a)=>e+a.amount,0);n=a.data.totalAmount-e}}if(e.createdAt)try{let a,t=e.createdAt;a="string"==typeof t?new Date(t):t instanceof Date?t:new Date,s=(0,q.format)(a,"MMMM d, yyyy h:mm a")}catch{s=void 0}return{patientName:r,appointmentDate:s,amountPaid:e.amount/100,totalAmount:t?t/100:void 0,balance:void 0!==n?n/100:void 0,paymentType:"string"==typeof e.method?e.method:"unknown",paymentFor:e.paymentPlanId?"Ortho Payment":"string"==typeof e.description?e.description:"Service Payment",notes:"string"==typeof e.description?e.description:null,clinicName:a.default.env.NEXT_PUBLIC_CLINIC_NAME||"Framada Dental Clinic",clinicPhone:a.default.env.NEXT_PUBLIC_CLINIC_PHONE||null,clinicAddress:a.default.env.NEXT_PUBLIC_CLINIC_ADDRESS||null,generatedAt:new Date().toLocaleString()}},ef=async e=>{try{let a=await ej(e);a&&(ed(a),ei(!0))}catch(e){console.error("Failed to prepare receipt:",e),l.toast.error("Failed to load receipt")}},eg=async e=>{try{let a,t,n=e.patient,s=n?.name||A.name;if(!s)return void l.toast.error("Patient information not available");let i=e.paymentPlanId,r="string"==typeof e.patientId?e.patientId:void 0;if(i&&r&&"string"==typeof r){let n=e.balance;if(null!=n&&"number"==typeof n){t=n;let e=await (0,J.getPaymentPlanByPatientId)(r);e.success&&e.data&&(a=e.data.totalAmount)}else{let[e,n]=await Promise.all([(0,J.getPaymentPlanByPatientId)(r),(0,Q.getPaymentsByPatientId)(r)]);if(e.success&&e.data){a=e.data.totalAmount;let s=(n.success?n.data.filter(a=>"completed"===a.status&&a.paymentPlanId===e.data?.id):[]).reduce((e,a)=>e+a.amount,0);t=e.data.totalAmount-s}}}let d="string"==typeof e.method?e.method:"unknown",c="string"==typeof e.description?e.description:void 0,o=e.createdAt,m=o instanceof Date||"string"==typeof o?o instanceof Date?o:new Date(o):void 0;(0,X.generatePaymentReceipt)({patientName:s,amountPaid:e.amount,paymentMethod:d,description:c||void 0,appointmentDate:m||void 0,paymentPlanTotal:a,paymentPlanBalance:t,paymentType:i?"plan":"one-time",autoPrint:!0})}catch(e){console.error("Failed to generate receipt:",e),l.toast.error("Failed to generate receipt")}},ey=A.dob?new Date(A.dob):null,ev=ey?Math.floor((Date.now()-ey.getTime())/315576e5):null,eb=ey?ey.toISOString().split("T")[0]:"",eN=e=>new Intl.NumberFormat("en-US",{style:"currency",currency:"GHS"}).format(e/100);return(0,t.jsxs)("div",{className:"flex flex-col gap-6 p-6",children:[(0,t.jsx)(i.Breadcrumb,{children:(0,t.jsxs)(i.BreadcrumbList,{children:[(0,t.jsx)(i.BreadcrumbItem,{children:(0,t.jsx)(i.BreadcrumbLink,{asChild:!0,children:(0,t.jsx)(r.default,{href:"/patients",children:"Patients"})})}),(0,t.jsx)(i.BreadcrumbSeparator,{}),(0,t.jsx)(i.BreadcrumbItem,{children:(0,t.jsx)(i.BreadcrumbPage,{children:A.name})})]})}),(0,t.jsxs)("div",{className:"flex items-start gap-6",children:[(0,t.jsx)(d.Avatar,{className:"h-24 w-24",children:A.profileImage?(0,t.jsx)(d.AvatarImage,{src:A.profileImage,alt:A.name}):(0,t.jsx)(d.AvatarFallback,{className:"text-2xl",children:A.name.charAt(0).toUpperCase()})}),(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3 mb-2",children:[(0,t.jsx)(Z,{label:"",value:A.name,onSave:e=>ex("name",e),type:"text",className:"text-3xl font-bold tracking-tight"}),A.isChild&&(0,t.jsx)(o.Badge,{variant:"secondary",children:"Child"}),A.isOrtho&&(0,t.jsx)(o.Badge,{variant:"outline",children:"Ortho"}),S&&(0,t.jsxs)(T.Button,{variant:"outline",size:"sm",className:"ml-auto",onClick:()=>eu(!0),children:[(0,t.jsx)(N.Pencil,{className:"mr-2 h-4 w-4"}),"Edit Profile"]})]}),(0,t.jsxs)("div",{className:"space-y-1",children:[(0,t.jsxs)("p",{className:"text-sm font-medium",children:["Patient ID:"," ",(0,t.jsx)("span",{className:"text-muted-foreground",children:A.patientId||"Not assigned"})]}),(0,t.jsxs)("p",{className:"text-muted-foreground",children:[A.email||"No email"," â€¢ ",A.phone||"No phone"]})]})]})]}),(0,t.jsx)(m.Separator,{}),(0,t.jsxs)(u.Tabs,{defaultValue:"personal",className:"w-full",children:[(0,t.jsxs)(u.TabsList,{children:[(0,t.jsx)(u.TabsTrigger,{value:"personal",children:"Personal Info"}),D&&(0,t.jsx)(u.TabsTrigger,{value:"medical",children:"Medical Records"}),(0,t.jsx)(u.TabsTrigger,{value:"payments",children:"Payment Records"})]}),(0,t.jsx)(u.TabsContent,{value:"personal",className:"space-y-6",children:(0,t.jsxs)("div",{className:"grid gap-6 md:grid-cols-2",children:[(0,t.jsxs)(c.Card,{children:[(0,t.jsxs)(c.CardHeader,{children:[(0,t.jsx)(c.CardTitle,{children:"Personal Information"}),(0,t.jsx)(c.CardDescription,{children:"Basic patient details"})]}),(0,t.jsxs)(c.CardContent,{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"Patient ID"}),(0,t.jsx)("p",{className:"font-medium",children:A.patientId||"Not assigned"})]}),(0,t.jsx)(Z,{label:"Gender",value:A.gender,onSave:e=>ex("gender",e),type:"select",options:[{value:"male",label:"Male"},{value:"female",label:"Female"}]}),(0,t.jsx)(Z,{label:"Date of Birth",value:eb,onSave:e=>ex("dob",e),type:"date"}),ev&&(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"Age"}),(0,t.jsxs)("p",{children:[ev," years"]})]}),A.occupation&&(0,t.jsx)(Z,{label:"Occupation",value:A.occupation,onSave:e=>ex("occupation",e),type:"text"}),(0,t.jsx)(Z,{label:"Nationality",value:A.nationality||"Ghana",onSave:e=>ex("nationality",e),type:"text"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"Joined At"}),(0,t.jsx)("p",{children:A.createdAt?(0,q.format)(new Date(A.createdAt),"MMMM d, yyyy"):"Unknown"})]})]}),A.address&&(0,t.jsx)(Z,{label:"Address",value:A.address,onSave:e=>ex("address",e),type:"textarea"})]})]}),A.isChild?(0,t.jsxs)(c.Card,{children:[(0,t.jsxs)(c.CardHeader,{children:[(0,t.jsx)(c.CardTitle,{children:"Guardian/Parent Information"}),(0,t.jsx)(c.CardDescription,{children:"Contact details for guardian"})]}),(0,t.jsxs)(c.CardContent,{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[A.guardianName&&(0,t.jsx)(Z,{label:"Name",value:A.guardianName,onSave:e=>ex("guardianName",e),type:"text"}),A.guardianPhone&&(0,t.jsx)(Z,{label:"Phone",value:A.guardianPhone,onSave:e=>ex("guardianPhone",e),type:"tel"}),A.guardianEmail&&(0,t.jsx)(Z,{label:"Email",value:A.guardianEmail,onSave:e=>ex("guardianEmail",e),type:"email"}),A.guardianOccupation&&(0,t.jsx)(Z,{label:"Occupation",value:A.guardianOccupation,onSave:e=>ex("guardianOccupation",e),type:"text"})]}),A.guardianAddress&&(0,t.jsx)(Z,{label:"Address",value:A.guardianAddress,onSave:e=>ex("guardianAddress",e),type:"textarea"})]})]}):(0,t.jsxs)(c.Card,{children:[(0,t.jsxs)(c.CardHeader,{children:[(0,t.jsx)(c.CardTitle,{children:"Contact Information"}),(0,t.jsx)(c.CardDescription,{children:"Patient contact details"})]}),(0,t.jsxs)(c.CardContent,{className:"space-y-4",children:[A.email&&(0,t.jsx)(Z,{label:"Email",value:A.email,onSave:e=>ex("email",e),type:"email"}),A.phone&&(0,t.jsx)(Z,{label:"Phone",value:A.phone,onSave:e=>ex("phone",e),type:"tel"})]})]}),(A.insuranceProvider||A.insurancePolicyNumber||A.emergencyContactName)&&(0,t.jsxs)(c.Card,{className:"md:col-span-2",children:[(0,t.jsxs)(c.CardHeader,{children:[(0,t.jsx)(c.CardTitle,{children:"Additional Information"}),(0,t.jsx)(c.CardDescription,{children:"Insurance and emergency contacts"})]}),(0,t.jsxs)(c.CardContent,{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[A.insuranceProvider&&(0,t.jsx)(Z,{label:"Insurance Provider",value:A.insuranceProvider,onSave:e=>ex("insuranceProvider",e),type:"text"}),A.insurancePolicyNumber&&(0,t.jsx)(Z,{label:"Policy Number",value:A.insurancePolicyNumber,onSave:e=>ex("insurancePolicyNumber",e),type:"text"})]}),A.emergencyContactName&&(0,t.jsxs)("div",{children:[(0,t.jsx)(Z,{label:"Emergency Contact",value:A.emergencyContactName,onSave:e=>ex("emergencyContactName",e),type:"text"}),A.emergencyContactPhone&&(0,t.jsx)(Z,{label:"Emergency Contact Phone",value:A.emergencyContactPhone,onSave:e=>ex("emergencyContactPhone",e),type:"tel",className:"mt-2"})]})]})]})]})}),D&&(0,t.jsx)(u.TabsContent,{value:"medical",className:"space-y-6",children:(0,t.jsxs)(c.Card,{children:[(0,t.jsxs)(c.CardHeader,{children:[(0,t.jsx)(c.CardTitle,{children:"Medical Records"}),(0,t.jsx)(c.CardDescription,{children:"Patient's medical history and records"})]}),(0,t.jsx)(c.CardContent,{children:0===h.length?(0,t.jsx)("p",{className:"text-center text-muted-foreground py-8",children:"No medical records found."}):(0,t.jsxs)(x.Table,{children:[(0,t.jsx)(x.TableHeader,{children:(0,t.jsxs)(x.TableRow,{children:[(0,t.jsx)(x.TableHead,{children:"Date"}),(0,t.jsx)(x.TableHead,{children:"Doctor"}),(0,t.jsx)(x.TableHead,{children:"Diagnosis"}),(0,t.jsx)(x.TableHead,{children:"Prescription"}),(0,t.jsx)(x.TableHead,{children:"Notes"}),(0,t.jsx)(x.TableHead,{className:"w-[50px]",children:"Actions"})]})}),(0,t.jsx)(x.TableBody,{children:h.map(e=>{let a=e.date||e.createdAt,n="string"==typeof a||a instanceof Date?new Date(a):new Date,s=e.doctor,l="string"==typeof e.diagnosis?e.diagnosis:void 0,i="string"==typeof e.prescription?e.prescription:void 0,r="string"==typeof e.notes?e.notes:void 0;return(0,t.jsxs)(x.TableRow,{children:[(0,t.jsx)(x.TableCell,{children:n.toLocaleDateString()}),(0,t.jsx)(x.TableCell,{children:s?.user?.name||"Unknown"}),(0,t.jsx)(x.TableCell,{children:l||"-"}),(0,t.jsx)(x.TableCell,{children:i||"-"}),(0,t.jsx)(x.TableCell,{className:"max-w-xs truncate",children:r||"-"}),(0,t.jsx)(x.TableCell,{children:(0,t.jsxs)(z.DropdownMenu,{children:[(0,t.jsx)(z.DropdownMenuTrigger,{asChild:!0,children:(0,t.jsxs)(T.Button,{variant:"ghost",className:"h-8 w-8 p-0",children:[(0,t.jsx)("span",{className:"sr-only",children:"Open menu"}),(0,t.jsx)(v.MoreHorizontal,{className:"h-4 w-4"})]})}),(0,t.jsxs)(z.DropdownMenuContent,{align:"end",children:[(0,t.jsxs)(z.DropdownMenuItem,{onClick:()=>{O(e),ee(!0)},children:[(0,t.jsx)(b.Eye,{className:"mr-2 h-4 w-4"}),"View Record"]}),S&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(z.DropdownMenuItem,{onClick:()=>{O(e),et(!0)},children:[(0,t.jsx)(N.Pencil,{className:"mr-2 h-4 w-4"}),"Edit Record"]}),(0,t.jsx)(z.DropdownMenuSeparator,{}),(0,t.jsxs)(z.DropdownMenuItem,{onClick:()=>{O(e),es(!0)},className:"text-destructive",children:[(0,t.jsx)(P.Trash2,{className:"mr-2 h-4 w-4"}),"Delete"]})]})]})]})})]},e.id)})})]})})]})}),(0,t.jsxs)(u.TabsContent,{value:"payments",className:"space-y-6",children:[(0,t.jsxs)(c.Card,{children:[(0,t.jsx)(c.CardHeader,{children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)(c.CardTitle,{children:"Payment Plan"}),(0,t.jsx)(c.CardDescription,{children:F?"Payment plan details for treatment":"No payment plan assigned yet"})]}),(0,t.jsx)(L,{patientId:A.id,existingPlan:F,onSuccess:eh,isAdmin:f})]})}),(0,t.jsx)(c.CardContent,{children:F?(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"Total Amount"}),(0,t.jsx)("p",{className:"text-lg font-semibold",children:eN(F.totalAmount)})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"Amount per Installment"}),(0,t.jsx)("p",{className:"text-lg font-semibold",children:F.amountPerInstallment?eN(F.amountPerInstallment):"Flexible"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"Payment Frequency"}),(0,t.jsx)("p",{className:"capitalize",children:F.paymentFrequency||"Flexible"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"Start Date"}),(0,t.jsx)("p",{children:new Date(F.startDate).toLocaleDateString()})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"Status"}),(0,t.jsx)(o.Badge,{variant:"activated"===F.status?"default":"completed"===F.status?"secondary":"overdue"===F.status||"paused"===F.status?"destructive":"outline",children:F.status})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"Plan Type"}),(0,t.jsx)(o.Badge,{variant:"outline",className:"capitalize",children:F.type||"fixed"})]})]}),F.notes&&(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"Notes"}),(0,t.jsx)("p",{className:"text-sm",children:F.notes})]}),(0,t.jsx)("div",{className:"flex gap-2 pt-2",children:"paused"===F.status?(0,t.jsxs)(T.Button,{variant:"destructive",size:"sm",onClick:async()=>{let e=await U(F.id);e.success?(l.toast.success("Payment plan activated"),eh()):l.toast.error(e.error||"Failed to activate payment plan")},children:[(0,t.jsx)(y.default,{className:"mr-2 h-4 w-4"}),"Paused"]}):"activated"===F.status?(0,t.jsxs)(T.Button,{variant:"outline",size:"sm",onClick:async()=>{let e=await E(F.id);e.success?(l.toast.success("Payment plan paused"),eh()):l.toast.error(e.error||"Failed to pause payment plan")},children:[(0,t.jsx)(g.default,{className:"mr-2 h-4 w-4"}),"Pause"]}):null})]}):(0,t.jsxs)("div",{className:"text-center py-8 text-muted-foreground",children:[(0,t.jsx)("p",{children:"No payment plan has been created for this patient yet."}),(0,t.jsx)("p",{className:"text-sm mt-2",children:'Click "Select Payment Plan" above to get started.'})]})})]}),(0,t.jsxs)(c.Card,{children:[(0,t.jsxs)(c.CardHeader,{children:[(0,t.jsx)(c.CardTitle,{children:"Payment Records"}),(0,t.jsx)(c.CardDescription,{children:"Patient's payment history"})]}),(0,t.jsx)(c.CardContent,{children:(0,t.jsxs)(u.Tabs,{defaultValue:"one-time",className:"w-full",children:[(0,t.jsxs)(u.TabsList,{className:"grid w-full grid-cols-2",children:[(0,t.jsx)(u.TabsTrigger,{value:"one-time",children:"One-Time Payments"}),(0,t.jsx)(u.TabsTrigger,{value:"plan",children:"Payment Plan"})]}),(0,t.jsx)(u.TabsContent,{value:"one-time",className:"mt-4",children:0===k.length?(0,t.jsx)("p",{className:"text-center text-muted-foreground py-8",children:"No one-time payments found."}):(0,t.jsxs)(x.Table,{children:[(0,t.jsx)(x.TableHeader,{children:(0,t.jsxs)(x.TableRow,{children:[(0,t.jsx)(x.TableHead,{children:"Date"}),(0,t.jsx)(x.TableHead,{children:"Amount"}),(0,t.jsx)(x.TableHead,{children:"Method"}),(0,t.jsx)(x.TableHead,{children:"Status"}),(0,t.jsx)(x.TableHead,{children:"Description"}),(0,t.jsx)(x.TableHead,{className:"w-[50px]",children:"Actions"})]})}),(0,t.jsx)(x.TableBody,{children:k.map(e=>{let a=e.createdAt,n="string"==typeof a||a instanceof Date?new Date(a):new Date,s="string"==typeof e.method?e.method:"unknown",l="string"==typeof e.status?e.status:"unknown",i="string"==typeof e.description?e.description:null;return(0,t.jsxs)(x.TableRow,{children:[(0,t.jsx)(x.TableCell,{children:n.toLocaleDateString()}),(0,t.jsx)(x.TableCell,{className:"font-medium",children:eN(e.amount)}),(0,t.jsx)(x.TableCell,{className:"capitalize",children:s.replace("_"," ")}),(0,t.jsx)(x.TableCell,{children:(0,t.jsx)(o.Badge,{variant:"completed"===l?"default":"pending"===l?"secondary":"failed"===l?"destructive":"outline",children:l})}),(0,t.jsx)(x.TableCell,{children:i&&i.split(" - ")[0]||"-"}),(0,t.jsx)(x.TableCell,{children:(0,t.jsxs)(z.DropdownMenu,{children:[(0,t.jsx)(z.DropdownMenuTrigger,{asChild:!0,children:(0,t.jsxs)(T.Button,{variant:"ghost",className:"h-8 w-8 p-0",children:[(0,t.jsx)("span",{className:"sr-only",children:"Open menu"}),(0,t.jsx)(v.MoreHorizontal,{className:"h-4 w-4"})]})}),(0,t.jsxs)(z.DropdownMenuContent,{align:"end",children:[(0,t.jsxs)(z.DropdownMenuItem,{onClick:()=>ef(e),children:[(0,t.jsx)(b.Eye,{className:"mr-2 h-4 w-4"}),"View Receipt"]}),(0,t.jsxs)(z.DropdownMenuItem,{onClick:()=>eg(e),children:[(0,t.jsx)(C.Printer,{className:"mr-2 h-4 w-4"}),"Print Receipt"]})]})]})})]},e.id)})})]})}),(0,t.jsxs)(u.TabsContent,{value:"plan",className:"mt-4 space-y-6",children:[A.isOrtho&&F&&(0,t.jsx)("div",{className:"p-4 rounded-lg border bg-muted/50",children:(0,t.jsxs)("div",{className:"grid grid-cols-3 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"Total Amount"}),(0,t.jsx)("p",{className:"text-lg font-semibold",children:eN(F.totalAmount)})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"Total Paid"}),(0,t.jsx)("p",{className:"text-lg font-semibold text-green-600",children:eN(R.filter(e=>"completed"===e.status).reduce((e,a)=>e+a.amount,0))})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"Outstanding Balance"}),(0,t.jsx)("p",{className:"text-lg font-semibold text-destructive",children:eN(F.totalAmount-R.filter(e=>"completed"===e.status).reduce((e,a)=>e+a.amount,0))})]})]})}),0===R.length?(0,t.jsx)("p",{className:"text-center text-muted-foreground py-8",children:"No plan installments found."}):(0,t.jsxs)(x.Table,{children:[(0,t.jsx)(x.TableHeader,{children:(0,t.jsxs)(x.TableRow,{children:[(0,t.jsx)(x.TableHead,{children:"Date"}),(0,t.jsx)(x.TableHead,{children:"Amount"}),(0,t.jsx)(x.TableHead,{children:"Method"}),(0,t.jsx)(x.TableHead,{children:"Status"}),(0,t.jsx)(x.TableHead,{children:"Description"}),(0,t.jsx)(x.TableHead,{className:"w-[50px]",children:"Actions"})]})}),(0,t.jsx)(x.TableBody,{children:R.map(e=>{let a=e.createdAt,n="string"==typeof a||a instanceof Date?new Date(a):new Date,s="string"==typeof e.method?e.method:"unknown",l="string"==typeof e.status?e.status:"unknown",i="string"==typeof e.description?e.description:null;return(0,t.jsxs)(x.TableRow,{children:[(0,t.jsx)(x.TableCell,{children:n.toLocaleDateString()}),(0,t.jsx)(x.TableCell,{className:"font-medium",children:eN(e.amount)}),(0,t.jsx)(x.TableCell,{className:"capitalize",children:s.replace("_"," ")}),(0,t.jsx)(x.TableCell,{children:(0,t.jsx)(o.Badge,{variant:"completed"===l?"default":"pending"===l?"secondary":"failed"===l?"destructive":"outline",children:l})}),(0,t.jsx)(x.TableCell,{children:i&&i.split(" - ")[0]||"-"}),(0,t.jsx)(x.TableCell,{children:(0,t.jsxs)(z.DropdownMenu,{children:[(0,t.jsx)(z.DropdownMenuTrigger,{asChild:!0,children:(0,t.jsxs)(T.Button,{variant:"ghost",className:"h-8 w-8 p-0",children:[(0,t.jsx)("span",{className:"sr-only",children:"Open menu"}),(0,t.jsx)(v.MoreHorizontal,{className:"h-4 w-4"})]})}),(0,t.jsxs)(z.DropdownMenuContent,{align:"end",children:[(0,t.jsxs)(z.DropdownMenuItem,{onClick:()=>ef(e),children:[(0,t.jsx)(b.Eye,{className:"mr-2 h-4 w-4"}),"View Receipt"]}),(0,t.jsxs)(z.DropdownMenuItem,{onClick:()=>eg(e),children:[(0,t.jsx)(C.Printer,{className:"mr-2 h-4 w-4"}),"Print Receipt"]})]})]})})]},e.id)})})]})]})]})})]})]})]}),H&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)($,{open:_,onOpenChange:ee,record:H}),(0,t.jsx)(G.EditMedicalRecordDialog,{open:ea,onOpenChange:et,record:H}),(0,t.jsx)(K.DeleteConfirmationDialog,{open:en,onOpenChange:es,onConfirm:ep,title:"Delete Medical Record",description:"Are you sure you want to delete this medical record? This action cannot be undone.",itemName:`Medical record from ${(()=>{let e=H.date;if(!e)return"unknown date";let a="string"==typeof e||e instanceof Date?new Date(e):null;return a?(0,q.format)(a,"MMMM d, yyyy"):"unknown date"})()}`,isLoading:ec})]}),er&&(0,t.jsx)(W.ReceiptViewDialog,{open:el,onOpenChange:ei,receiptData:er}),(0,t.jsx)(Y.EditPatientDialog,{patient:A,open:em,onOpenChange:eu})]})}e.s(["PatientDetailContent",()=>ee],624819)}]);